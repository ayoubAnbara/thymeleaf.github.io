<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
	<title>Tutorial: Using Thymeleaf</title>
	<meta charset="utf-8">
	<meta name="generator" content="pandoc">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta name="format-detection" content="telephone=no"/>

	<link rel="icon" href="images/icon.png"/>
	<link rel="stylesheet" href="styles/fonts/open-sans.css"/>
	<link rel="stylesheet" href="styles/fonts/source-sans-pro.css"/>
	<link rel="stylesheet" href="styles/normalize.css"/>
	<link rel="stylesheet" href="styles/thymeleaf.css"/>
	<link rel="stylesheet" href="styles/thymeleaf-screen.css" media="screen"/>
	<link rel="stylesheet" href="styles/thymeleaf-print.css" media="print"/>

	<script src="scripts/prettify.min.js"></script>
	<script src="scripts/jquery-1.9.1.min.js"></script>
	<script src="scripts/thymeleaf.js"></script>

</head>

<body>

	<div id="documentation-wrapper">

	<div id="title-block-wrapper">
		<header id="title-block">
			<img id="doc-banner" class="banner" src="images/header.png" alt="Thymeleaf logo"/>
			<h1 id="doc-title" class="title">Tutorial: Using Thymeleaf</h1>
			<div id="doc-info">
				<div id="doc-version">
					<span class="info-header">Document version:</span> 20130526 - 26 May 2013
				</div>
				<div id="project-version">
					<span class="info-header">Project Version:</span> 2.0.16
				</div>
				<div id="project-website">
					<span class="info-header">Project web site:</span>
					<a href="http://www.thymeleaf.org">http://www.thymeleaf.org</a>
				</div>
			</div>
		</header>
	</div>

	<div id="toc-wrapper">
		<nav id="toc">
<ul>
<li><a href="#introducing-thymeleaf">1 Introducing Thymeleaf</a><ul>
<li><a href="#what-is-thymeleaf">1.1 What is Thymeleaf?</a></li>
<li><a href="#what-kind-of-templates-can-thymeleaf-process">1.2 What kind of templates can Thymeleaf process?</a></li>
<li><a href="#dialects-the-standard-dialect">1.3 Dialects: The Standard Dialect</a></li>
<li><a href="#overall-architecture">1.4 Overall Architecture</a></li>
<li><a href="#before-going-any-further-you-should-read...">1.5 Before going any further, you should read...</a></li>
</ul></li>
<li><a href="#the-good-thymes-virtual-grocery">2 The Good Thymes Virtual Grocery</a><ul>
<li><a href="#a-website-for-a-grocery">2.1 A website for a grocery</a></li>
<li><a href="#creating-and-configuring-the-template-engine">2.2 Creating and configuring the Template Engine</a><ul>
<li><a href="#the-template-resolver">The Template Resolver</a></li>
<li><a href="#the-template-engine">The Template Engine</a></li>
</ul></li>
</ul></li>
<li><a href="#using-texts">3 Using texts</a><ul>
<li><a href="#a-multi-language-welcome">3.1 A multi-language welcome</a><ul>
<li><a href="#using-thtext-and-externalizing-text">Using th:text and externalizing text</a></li>
<li><a href="#contexts">Contexts</a></li>
<li><a href="#executing-the-template-engine">Executing the template engine</a></li>
</ul></li>
<li><a href="#more-on-texts-and-variables">3.2 More on texts and variables</a><ul>
<li><a href="#unescaped-text">Unescaped Text</a></li>
<li><a href="#using-and-displaying-variables">Using and displaying variables</a></li>
</ul></li>
</ul></li>
<li><a href="#standard-expression-syntax">4 Standard Expression Syntax</a><ul>
<li><a href="#messages">4.1 Messages</a></li>
<li><a href="#variables">4.2 Variables</a><ul>
<li><a href="#expression-basic-objects">Expression basic objects</a></li>
<li><a href="#expression-utility-objects">Expression utility objects</a></li>
<li><a href="#reformatting-dates-in-our-home-page">Reformatting dates in our home page</a></li>
</ul></li>
<li><a href="#expressions-on-selections-asterisk-syntax">4.3 Expressions on selections (asterisk syntax)</a></li>
<li><a href="#link-urls">4.4 Link URLs</a><ul>
<li><a href="#a-menu-for-our-home-page">A menu for our home page</a></li>
</ul></li>
<li><a href="#literals">4.5 Literals</a></li>
<li><a href="#concatenating-texts">4.6 Concatenating texts</a></li>
<li><a href="#arithmetic-operations">4.7 Arithmetic operations</a></li>
<li><a href="#comparators-and-equality">4.8 Comparators and Equality</a></li>
<li><a href="#conditional-expressions">4.9 Conditional expressions</a></li>
<li><a href="#default-expressions-elvis-operator">4.10 Default expressions (Elvis operator)</a></li>
<li><a href="#preprocessing">4.11 Preprocessing</a></li>
</ul></li>
<li><a href="#setting-attribute-values">5 Setting attribute values</a><ul>
<li><a href="#setting-the-value-of-any-attribute">5.1 Setting the value of any attribute</a></li>
<li><a href="#setting-value-to-specific-attributes">5.2 Setting value to specific attributes</a></li>
<li><a href="#setting-more-than-one-value-at-a-time">5.3 Setting more than one value at a time</a></li>
<li><a href="#appending-and-prepending">5.4 Appending and prepending</a></li>
<li><a href="#fixed-value-boolean-attributes">5.5 Fixed-value boolean attributes</a></li>
</ul></li>
<li><a href="#iteration">6 Iteration</a><ul>
<li><a href="#iteration-basics">6.1 Iteration basics</a><ul>
<li><a href="#using-theach">Using th:each</a></li>
<li><a href="#iterable-values">Iterable values</a></li>
</ul></li>
<li><a href="#keeping-iteration-status">6.2 Keeping iteration status</a></li>
</ul></li>
<li><a href="#conditional-evaluation">7 Conditional evaluation</a><ul>
<li><a href="#simple-conditionals-if-and-unless">7.1 Simple conditionals: &quot;if&quot; and &quot;unless&quot;</a></li>
<li><a href="#switch-statements">7.2 Switch statements</a></li>
</ul></li>
<li><a href="#template-layout">8 Template Layout</a><ul>
<li><a href="#including-template-fragments">8.1 Including template fragments</a></li>
<li><a href="#removing-template-fragments">8.2 Removing template fragments</a></li>
</ul></li>
<li><a href="#local-variables">9 Local variables</a></li>
<li><a href="#attribute-precedence">10 Attribute precedence</a></li>
<li><a href="#inlining">11 Inlining</a><ul>
<li><a href="#text-inlining">11.1 Text inlining</a></li>
<li><a href="#script-inlining-javascript-and-dart">11.2 Script inlining (JavaScript and Dart)</a><ul>
<li><a href="#adding-code">Adding code</a></li>
<li><a href="#removing-code">Removing code</a></li>
</ul></li>
</ul></li>
<li><a href="#validation-and-doctypes">12 Validation and Doctypes</a><ul>
<li><a href="#validating-templates">12.1 Validating templates</a></li>
<li><a href="#doctype-translation">12.2 Doctype translation</a></li>
</ul></li>
<li><a href="#some-more-pages-for-our-grocery">13 Some more pages for our grocery</a><ul>
<li><a href="#order-list">13.1 Order List</a></li>
<li><a href="#order-details">13.2 Order Details</a></li>
</ul></li>
<li><a href="#more-on-configuration">14 More on configuration</a><ul>
<li><a href="#template-resolvers">14.1 Template Resolvers</a></li>
<li><a href="#message-resolvers">14.2 Message Resolvers</a></li>
<li><a href="#logging">14.3 Logging</a></li>
</ul></li>
<li><a href="#template-cache">15 Template Cache</a></li>
<li><a href="#appendix-expression-utility-objects">16 Appendix: Expression Utility Objects</a></li>
</ul>
		</nav>
	</div>

	<div id="content-wrapper">
		<div id="content">
<section id="introducing-thymeleaf" class="level1">
<h1><a href="#introducing-thymeleaf">1 Introducing Thymeleaf</a></h1>
<section id="what-is-thymeleaf" class="level2">
<h2><a href="#what-is-thymeleaf">1.1 What is Thymeleaf?</a></h2>
<p>Thymeleaf is a Java library. It is an XML/XHTML/HTML5 template engine able to apply a set of transformations to template files in order to display data and/or text produced by your applications.</p>
<p>It is better suited for serving XHTML/HTML5 in web applications, but it can process any XML file, be it in web or in standalone applications.</p>
<p>The main goal of Thymeleaf is to provide an elegant and well-formed way of creating templates. In order to achieve this, it is based on XML tags and attributes that define the execution of predefined logic on the <em>DOM (Document Object Model)</em>, instead of explicitly writing that logic as code inside the template.</p>
<p>Its architecture allows a fast processing of templates, relying on intelligent caching of parsed files in order to use the least possible amount of I/O operations during execution.</p>
<p>And last but not least, Thymeleaf has been designed from the beginning with XML and Web standards in mind, allowing you to create fully validating templates if that is a need for you.</p>
</section>
<section id="what-kind-of-templates-can-thymeleaf-process" class="level2">
<h2><a href="#what-kind-of-templates-can-thymeleaf-process">1.2 What kind of templates can Thymeleaf process?</a></h2>
<p>Out-of-the-box, Thymeleaf allows you to process six kinds of templates, each of which is called a Template Mode:</p>
<ul>
<li>XML</li>
<li>Valid XML</li>
<li>XHTML</li>
<li>Valid XHTML</li>
<li>HTML5</li>
<li>Legacy HTML5</li>
</ul>
<p>All of these modes refer to well-formed XML files except the <em>Legacy HTML5</em> mode, which allows you to process HTML5 files with features such as standalone (not closed) tags, tag attributes without a value or not written between commas. In order to process files in this specific mode, Thymeleaf will first perform a transformation that will convert your files to well-formed XML files which are still perfectly valid HTML5 (and are in fact the recommended way to create HTML5 code)<sup><a href="#fn1" class="footnoteRef" id="fnref1">1</a></sup>.</p>
<p>Also note that validation is only available for XML and XHTML templates.</p>
<p>Nevertheless, these are not the only types of template that Thymeleaf can process, and the user is always able to define his/her own mode by specifying both a way to <em>parse</em> templates in this mode and a way to <em>write</em> the results. This way, anything that can be modelled as a DOM tree (be it XML or not) could effectively be processed as a template by Thymeleaf.</p>
</section>
<section id="dialects-the-standard-dialect" class="level2">
<h2><a href="#dialects-the-standard-dialect">1.3 Dialects: The Standard Dialect</a></h2>
<p>Thymeleaf is an extremely extensible template engine (in fact it should be better called a <em>template engine framework</em>) that allows you to completely define the DOM nodes that will be processed in your templates and also how they will be processed.</p>
<p>An object that applies some logic to a DOM node is called a <em>processor</em>, and a set of these processors –plus some extra artifacts– is called a dialect, of which Thymeleaf's core library provides one out-of-the-box called the <em>Standard Dialect</em>, which should be enough for the needs of a big percent of users.</p>
<p><em>The Standard Dialect is the dialect this tutorial covers</em>. Every attribute and syntax feature you will learn about in the following pages is defined by this dialect, even if that isn't explicitly mentioned.</p>
<p>Of course, users may create their own dialects (even extending the Standard one) if they want to define their own processing logic while taking advantage of the library's advanced features. A Template Engine can be configured several dialects at a time.</p>
<blockquote>
<p>The official thymeleaf-spring3 integration package defines a dialect called the &quot;SpringStandard Dialect&quot;, mostly equivalent to the Standard Dialect but with small adaptations to make better use of some features in Spring Framework (for example, by using Spring Expression Language instead of Thymeleaf's standard OGNL). So if you are a Spring MVC user you are not wasting your time, as almost everything you learn here will be of use in your Spring applications.</p>
</blockquote>
<p>The Thymeleaf Standard Dialect can process templates in any mode, but is especially suited for web-oriented template modes (XHTML and HTML5 ones). Besides HTML5, it specifically supports and validates the following XHTML specifications: <em>XHTML 1.0 Transitional</em>, <em>XHTML 1.0 Strict</em>, <em>XHTML 1.0 Frameset</em>, and <em>XHTML 1.1</em>.</p>
<p>Also, the Standard Dialect does not include any processors to be applied on tags –called elements in DOM terminology–: it is an <em>attribute-only dialect</em>. This allows browsers to correctly display XHTML/HTML5 template files even before being processed, because they will simply ignore the additional attributes. For example, while a JSP using tag libraries could include a fragment of code not directly displayable by a browser like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form:inputText</span><span class="ot"> name=</span><span class="st">&quot;userName&quot;</span><span class="ot"> value=</span><span class="st">&quot;${user.name}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>...the Thymeleaf Standard Dialect would allow us to achieve the same functionality with:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> name=</span><span class="st">&quot;userName&quot;</span><span class="ot"> value=</span><span class="st">&quot;James Carrot&quot;</span><span class="ot"> th:value=</span><span class="st">&quot;${user.name}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>Which not only will be correctly displayed by browsers, but also allow us to (optionally) specify a value attribute in it (&quot;James Carrot&quot;, in this case) that will be displayed when the prototype is statically opened in a browser, and that will be substituted by the value resulting from the evaluation of <code>${user.name}</code> during Thymeleaf processing of the template.</p>
<p>If needed, this will allow your designer and developer to work on the very same template file and reduce the effort required to transform a static prototype into a working template file. The ability to do this is a feature usually called <em>Natural Templating</em>.</p>
</section>
<section id="overall-architecture" class="level2">
<h2><a href="#overall-architecture">1.4 Overall Architecture</a></h2>
<p>Thymeleaf's core is a DOM processing engine. Specifically, it uses its own high-performance DOM implementation –not the standard DOM API– for building in-memory tree representations of your templates, on which it later operates by traversing their nodes and executing processors on them that modify the DOM according to the current <em>configuration</em> and the set of data that is passed to the template for its representation –known as the context.</p>
<p>The use of a DOM template representation makes it very well suited for web applications because web documents are very often represented as object trees (in fact DOM trees are the way browsers represent web pages in memory). Also, building on the idea that most web applications use only a few dozen templates, that these are not big files and that they don't normally change while the application is running, Thymeleaf's usage of an in-memory cache of parsed template DOM trees allows it to be fast in production environments, because very little I/O is needed (if any) for most template processing operations.</p>
<blockquote>
<p>If you want more detail, later in this tutorial there is an entire chapter dedicated to caching and to the way Thymeleaf optimizes memory and resource usage for faster operation.</p>
</blockquote>
<p>Nevertheless, there is a restriction: this architecture also requires the use of bigger amounts of memory space for each template execution than other template parsing/processing approaches, which means that you should not use the library for creating big data XML documents (as opposed to web documents). As a general rule of thumb (and always depending on the memory size of your JVM), if you are generating XML files with sizes around the tens of megabytes in a single template execution, you probably should not be using Thymeleaf.</p>
<blockquote>
<p>The reason we consider this restriction only applies to data XML files and not web XHTML/HTML5 is that you should never generate web documents so big that your users' browsers set ablaze and/or explode – remember that these browsers will also have to create DOM trees for your pages!</p>
</blockquote>
</section>
<section id="before-going-any-further-you-should-read..." class="level2">
<h2><a href="#before-going-any-further-you-should-read...">1.5 Before going any further, you should read...</a></h2>
<p>Thymeleaf is especially suited for working in web applications. And web applications are based on a series of standards that everyone should know very well but few do – even if they have been working with them for years.</p>
<p>With the advent of HTML5, the state of the art in web standards today is more confusing than ever... <em>are we going back from XHTML to HTML? Will we abandon XML syntax? Why is nobody talking about XHTML 2.0 anymore?</em></p>
<p>So before going any further in this tutorial, you are strongly advised to read an article on Thymeleaf's web site called <em>&quot;From HTML to HTML (via HTML)&quot;</em>, which you can find at this address: <a href="http://www.thymeleaf.org/fromhtmltohtmlviahtml.html">http://www.thymeleaf.org/fromhtmltohtmlviahtml.html</a></p>
</section>
</section>
<section id="the-good-thymes-virtual-grocery" class="level1">
<h1><a href="#the-good-thymes-virtual-grocery">2 The Good Thymes Virtual Grocery</a></h1>
<section id="a-website-for-a-grocery" class="level2">
<h2><a href="#a-website-for-a-grocery">2.1 A website for a grocery</a></h2>
<p>In order to better explain the concepts involved in processing templates with Thymeleaf, this tutorial will use a demo application you can download from the project web site.</p>
<p>This application represents the web site of an imaginary virtual grocery, and will provide us with the adequate scenarios to exemplify diverse Thymeleaf features.</p>
<p>We will need a quite simple set of model entities for our application: <code>Products</code> which are sold to <code>Customers</code> by creating <code>Orders</code>. We will also be managing <code>Comments</code> about those <code>Products</code>:</p>
<figure>
<img src="images/using-thymeleaf/gtvg-model.png" alt="Example application model" /><figcaption>Example application model</figcaption>
</figure>
<p>Our small application will also have a very simple service layer, composed by <code>Service</code> objects containing methods like:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> ProductService {

    ...

    public List&lt;Product&gt; <span class="fu">findAll</span>() {
        return ProductRepository.<span class="fu">getInstance</span>().<span class="fu">findAll</span>();
    }

    public Product <span class="fu">findById</span>(Integer id) {
        return ProductRepository.<span class="fu">getInstance</span>().<span class="fu">findById</span>(id);
    }
    
}</code></pre>
<p>Finally, at the web layer our application will have a filter that will delegate execution to Thymeleaf-enabled commands depending on the request URL:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">private</span> <span class="dt">boolean</span> <span class="fu">process</span>(HttpServletRequest request, HttpServletResponse response)
        throws ServletException {
        
    try {
            
        <span class="co">/*</span>
<span class="co">         * Query controller/URL mapping and obtain the controller</span>
<span class="co">         * that will process the request. If no controller is available,</span>
<span class="co">         * return false and let other filters/servlets process the request.</span>
<span class="co">         */</span>
        IGTVGController controller = GTVGApplication.<span class="fu">resolveControllerForRequest</span>(request);
        <span class="fu">if</span> (controller == <span class="kw">null</span>) {
            return <span class="kw">false</span>;
        }
        <span class="co">/*</span>
<span class="co">         * Obtain the TemplateEngine instance.</span>
<span class="co">         */</span>
        TemplateEngine templateEngine = GTVGApplication.<span class="fu">getTemplateEngine</span>();
            
        <span class="co">/*</span>
<span class="co">         * Write the response headers</span>
<span class="co">         */</span>
        response.<span class="fu">setContentType</span>(<span class="st">&quot;text/html;charset=UTF-8&quot;</span>);
        response.<span class="fu">setHeader</span>(<span class="st">&quot;Pragma&quot;</span>, <span class="st">&quot;no-cache&quot;</span>);
        response.<span class="fu">setHeader</span>(<span class="st">&quot;Cache-Control&quot;</span>, <span class="st">&quot;no-cache&quot;</span>);
        response.<span class="fu">setDateHeader</span>(<span class="st">&quot;Expires&quot;</span>, <span class="dv">0</span>);

        <span class="co">/*</span>
<span class="co">         * Execute the controller and process view template,</span>
<span class="co">         * writing the results to the response writer.</span>
<span class="co">         */</span>
        controller.<span class="fu">process</span>(
                request, response, <span class="kw">this</span>.<span class="fu">servletContext</span>, templateEngine);

        return <span class="kw">true</span>;
            
    } <span class="kw">catch</span> (Exception e) {
        throw <span class="kw">new</span> <span class="fu">ServletException</span>(e);
    }
        
}    </code></pre>
<p>This is our <code>IGTVGController</code> interface:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">interface</span> IGTVGController {

    public String <span class="fu">process</span>(
            HttpServletRequest request, HttpServletResponse response,
            ServletContext servletContext, TemplateEngine templateEngine);    
    
}</code></pre>
<p>All we have to do now is create implementations of the <code>IGTVGController</code> interface, retrieving data from the services and processing templates using the <code>TemplateEngine</code> object.</p>
<p>In the end, it will look like this:</p>
<figure>
<img src="images/using-thymeleaf/gtvg-view.png" alt="Example application home page" /><figcaption>Example application home page</figcaption>
</figure>
<p>But first let's see how that template engine is initialized.</p>
</section>
<section id="creating-and-configuring-the-template-engine" class="level2">
<h2><a href="#creating-and-configuring-the-template-engine">2.2 Creating and configuring the Template Engine</a></h2>
<p>The <em>process(...)</em> method in our filter contained this sentence:</p>
<pre class="sourceCode java"><code class="sourceCode java">TemplateEngine templateEngine = GTVGApplication.<span class="fu">getTemplateEngine</span>();</code></pre>
<p>Which means that the <em>GTVGApplication</em> class is in charge of creating and configuring one of the most important objects in a Thymeleaf-enabled application: The <code>TemplateEngine</code> instance.</p>
<p>Our <code>org.thymeleaf.TemplateEngine</code> object is initialized like this:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> GTVGApplication {
  
    
    ...
    private <span class="dt">static</span> TemplateEngine templateEngine;
    ...
    
    
    static {
        ...
        <span class="fu">initializeTemplateEngine</span>();
        ...
    }
    
    
    private <span class="dt">static</span> <span class="dt">void</span> <span class="fu">initializeTemplateEngine</span>() {
        
        ServletContextTemplateResolver templateResolver = <span class="kw">new</span> <span class="fu">ServletContextTemplateResolver</span>();
        <span class="co">// XHTML is the default mode, but we will set it anyway for better understanding of code</span>
        templateResolver.<span class="fu">setTemplateMode</span>(<span class="st">&quot;XHTML&quot;</span>);
        <span class="co">// This will convert &quot;home&quot; to &quot;/WEB-INF/templates/home.html&quot;</span>
        templateResolver.<span class="fu">setPrefix</span>(<span class="st">&quot;/WEB-INF/templates/&quot;</span>);
        templateResolver.<span class="fu">setSuffix</span>(<span class="st">&quot;.html&quot;</span>);
        <span class="co">// Set template cache TTL to 1 hour. If not set, entries would live in cache until expelled by LRU</span>
        templateResolver.<span class="fu">setCacheTTLMs</span>(3600000L);
        
        templateEngine = <span class="kw">new</span> <span class="fu">TemplateEngine</span>();
        templateEngine.<span class="fu">setTemplateResolver</span>(templateResolver);
        
    }
    
    ...

}</code></pre>
<p>Of course there are many ways of configuring a <code>TemplateEngine</code> object, but for now these few lines of code will teach us enough about the steps needed.</p>
<section id="the-template-resolver" class="level3">
<h3><a href="#the-template-resolver">The Template Resolver</a></h3>
<p>Let's start with the Template Resolver:</p>
<pre class="sourceCode java"><code class="sourceCode java">ServletContextTemplateResolver templateResolver = <span class="kw">new</span> <span class="fu">ServletContextTemplateResolver</span>();</code></pre>
<p>Template Resolvers are objects that implement an interface from the Thymeleaf API called <code>org.thymeleaf.templateresolver.ITemplateResolver</code>:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">interface</span> ITemplateResolver {

    ...
  
    <span class="co">/*</span>
<span class="co">     * Templates are resolved by String name (templateProcessingParameters.getTemplateName())</span>
<span class="co">     * Will return null if template cannot be handled by this template resolver.</span>
<span class="co">     */</span>
    public TemplateResolution <span class="fu">resolveTemplate</span>(TemplateProcessingParameters templateProcessingParameters);

}</code></pre>
<p>These objects are in charge of determining how our templates will be accessed, and in this GTVG application, the <code>org.thymeleaf.templateresolver.ServletContextTemplateResolver</code> implementation that we are using specifies that we are going to retrieve our template files as resources from the <em>Servlet Context</em>: an application-wide <code>javax.servlet.ServletContext</code> object that exists in every Java web application, and that resolves resources considering the web application root as the root for resource paths.</p>
<p>But that's not all we can say about the template resolver, because we can set some configuration parameters on it. First, the template mode, one of the standard ones:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">setTemplateMode</span>(<span class="st">&quot;XHTML&quot;</span>);</code></pre>
<p>XHTML is the default template mode for <code>ServletContextTemplateResolver</code>, but it is good practice to establish it anyway so that our code documents clearly what is going on.</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">setPrefix</span>(<span class="st">&quot;/WEB-INF/templates/&quot;</span>);
templateResolver.<span class="fu">setSuffix</span>(<span class="st">&quot;.html&quot;</span>);</code></pre>
<p>These <em>prefix</em> and <em>suffix</em> do exactly what it looks like: modify the template names that we will be passing to the engine for obtaining the real resource names to be used.</p>
<p>Using this configuration, the template name <em>&quot;product/list&quot;</em> would correspond to:</p>
<pre class="sourceCode java"><code class="sourceCode java">servletContext.<span class="fu">getResourceAsStream</span>(<span class="st">&quot;/WEB-INF/templates/product/list.html&quot;</span>)</code></pre>
<p>Optionally, the amount of time that a parsed template living in cache will be considered valid can be configured at the Template Resolver by means of the <em>cacheTTLMs</em> property:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">setCacheTTLMs</span>(3600000L);</code></pre>
<p>Of course, a template can be expelled from cache before that TTL is reached if the max cache size is reached and it is the oldest entry currently cached.</p>
<blockquote>
<p>Cache behaviour and sizes can be defined by the user by implementing the <code>ICacheManager</code> interface or simply modifying the <code>StandardCacheManager</code> object set to manage caches by default.</p>
</blockquote>
<p>We will learn more about template resolvers later. Now let's have a look at the creation of our Template Resolver object.</p>
</section>
<section id="the-template-engine" class="level3">
<h3><a href="#the-template-engine">The Template Engine</a></h3>
<p>Template Engine objects are of class <em>org.thymeleaf.TemplateEngine</em>, and these are the lines that created our engine in the current example:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateEngine = <span class="kw">new</span> <span class="fu">TemplateEngine</span>();
templateEngine.<span class="fu">setTemplateResolver</span>(templateResolver);</code></pre>
<p>Rather simple, isn't it? All we need is to create an instance and set the Template Resolver to it.</p>
<p>A template resolver is the only required parameter a <code>TemplateEngine</code> needs, although of course there are many others that will be covered later (message resolvers, cache sizes, etc). For now, this is all we need.</p>
<p>Out Template Engine is now ready and we can start creating our pages using Thymeleaf.</p>
</section>
</section>
</section>
<section id="using-texts" class="level1">
<h1><a href="#using-texts">3 Using texts</a></h1>
<section id="a-multi-language-welcome" class="level2">
<h2><a href="#a-multi-language-welcome">3.1 A multi-language welcome</a></h2>
<p>Our first task will be to create a home page for our grocery site.</p>
<p>The first version we will write of this page will be extremely simple: just a title and a welcome message. This is our <code>/WEB-INF/templates/home.html</code> file:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span><span class="ot"> href=</span><span class="st">&quot;../../css/gtvg.css&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/css/gtvg.css}&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>
  
    <span class="kw">&lt;p</span><span class="ot"> th:text=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span>
  
  <span class="kw">&lt;/body&gt;</span>

<span class="kw">&lt;/html&gt;</span></code></pre>
<p>The first thing you will notice here is that this file is XHTML that can be correctly displayed by any browser, because it does not include any non-XHTML tags (and browsers ignore all attributes they don't understand, like <code>th:text</code>). Also, browsers will display it in standards mode (not in quirks mode), because it has a well-formed <code>DOCTYPE</code> declaration.</p>
<p>Next, this is also <em>valid</em> XHTML<sup><a href="#fn2" class="footnoteRef" id="fnref2">2</a></sup>, because we have specified a Thymeleaf DTD which defines attributes like <code>th:text</code> so that your templates can be considered valid. And even more: once the template is processed (and all <code>th:*</code> attributes are removed), Thymeleaf will automatically substitute that DTD declaration in the <code>DOCTYPE</code> clause by a standard <code>XHTML 1.0 Strict</code> one (we will leave this DTD translation features for a later chapter).</p>
<p>A thymeleaf namespace is also being declared for <code>th:*</code> attributes:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span></code></pre>
<p>Note that, if we hadn't cared about our template's validity or well-formedness at all, we could have simply specified a standard <code>XHTML 1.0 Strict DOCTYPE</code>, along with no xmlns namespace declarations:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span><span class="ot"> href=</span><span class="st">&quot;../../css/gtvg.css&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/css/gtvg.css}&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>
  
    <span class="kw">&lt;p</span><span class="ot"> th:text=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span>
  
  <span class="kw">&lt;/body&gt;</span>

<span class="kw">&lt;/html&gt;</span></code></pre>
<p>...and this would still be perfectly processable by Thymeleaf in the XHTML mode (although probably our IDE would make our life quite miserable showing warnings everywhere).</p>
<p>But enough about validation. Now for the really interesting part of the template: let's see what that <code>th:text</code> attribute is about.</p>
<section id="using-thtext-and-externalizing-text" class="level3">
<h3><a href="#using-thtext-and-externalizing-text">Using th:text and externalizing text</a></h3>
<p>Externalizing text is extracting fragments of template code out of template files so that they can be kept in specific separate files (typically <code>.properties</code> files) and that they can be easily substituted by equivalent texts written in other languages (a process called internationalization or simply <em>i18n</em>). Externalized fragments of text are usually called &quot;messages&quot;.</p>
<p>Messages have always a key that identifies them, and Thymeleaf allows you to specify that a text should correspond to a specific message with the <code>#{...}</code> syntax:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:text=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>What we can see here are in fact two different features of the Thymeleaf Standard Dialect:</p>
<ul>
<li>The <code>th:text</code> attribute, which evaluates its value expression and sets the result of this evaluation as the body of the tag it is in, effectively substituting that &quot;Welcome to our grocery store!&quot; text we see in the code.</li>
<li>The <code>#{home.welcome}</code> expression, specified in the <em>Standard Expression Syntax</em>, specifying that the text to be used by the <code>th:text</code> attribute should be the message with the <code>home.welcome</code> key corresponding to whichever locale we are processing the template with.</li>
</ul>
<p>Now, where is this externalized text?</p>
<p>The location of externalized text in Thymeleaf is fully configurable, and it will depend on the specific <code>org.thymeleaf.messageresolver.IMessageResolver</code> implementation being used. Normally, an implementation based on <code>.properties</code> files will be used, but we could create our own implementations if we wanted, for example, to obtain messages from a database.</p>
<p>However, we have not specified a message resolver to our Template Engine during initialization, and that means that our application is using the <em>Standard Message Resolver</em>, implemented by class <code>org.thymeleaf.messageresolver.StandardMessageResolver</code>.</p>
<p>This standard message resolver expects to find messages for <code>/WEB-INF/templates/home.html</code> in .properties files in the same folder and with the same name as the template, like:</p>
<ul>
<li><code>/WEB-INF/templates/home_en.properties</code> for English texts.</li>
<li><code>/WEB-INF/templates/home_es.properties</code> for Spanish language texts.</li>
<li><code>/WEB-INF/templates/home_pt_BR.properties</code> for Portuguese (Brazil) language texts.</li>
<li><code>/WEB-INF/templates/home.properties</code> for default texts (if locale is not matched).</li>
</ul>
<p>Let's have a look at our <code>home_es.properties</code> file:</p>
<pre><code>home.welcome=¡Bienvenido a nuestra tienda de comestibles!</code></pre>
<p>This is all we need for making Thymeleaf process our template. Let's create our Home controller then.</p>
</section>
<section id="contexts" class="level3">
<h3><a href="#contexts">Contexts</a></h3>
<p>In order to process our template, we will create a <code>HomeController</code> class implementing the <code>IGTVGController</code> interface we saw before:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> HomeController <span class="kw">implements</span> IGTVGController {

    public <span class="dt">void</span> <span class="fu">process</span>(
            HttpServletRequest request, HttpServletResponse response,
            ServletContext servletContext, TemplateEngine templateEngine) {
        
        WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());
        templateEngine.<span class="fu">process</span>(<span class="st">&quot;home&quot;</span>, ctx, response.<span class="fu">getWriter</span>());
        
    }

}</code></pre>
<p>The first thing we can see here is the creation of a context. A Thymeleaf context is an object implementing the <code>org.thymeleaf.context.IContext</code> interface. Contexts should contain all the data required for an execution of the Template Engine in a variables map, and also reference the Locale that must be used for externalized messages.</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">interface</span> IContext {

    public VariablesMap&lt;String,Object&gt; <span class="fu">getVariables</span>();
    public Locale <span class="fu">getLocale</span>();
    ...
    
}</code></pre>
<p>There is a specialized extension of this interface, <code>org.thymeleaf.context.IWebContext</code>:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">interface</span> IWebContext <span class="kw">extends</span> IContext {
    
    public HttpSerlvetRequest <span class="fu">getHttpServletRequest</span>();
    public HttpSession <span class="fu">getHttpSession</span>();
    public ServletContext <span class="fu">getServletContext</span>();
    
    public VariablesMap&lt;String,String[]&gt; <span class="fu">getRequestParameters</span>();
    public VariablesMap&lt;String,Object&gt; <span class="fu">getRequestAttributes</span>();
    public VariablesMap&lt;String,Object&gt; <span class="fu">getSessionAttributes</span>();
    public VariablesMap&lt;String,Object&gt; <span class="fu">getApplicationAttributes</span>();
    
}</code></pre>
<p>The Thymeleaf core library offers an implementation of each of these interfaces:</p>
<ul>
<li><code>org.thymeleaf.context.Context</code> implements <code>IContext</code></li>
<li><code>org.thymeleaf.context.WebContext</code> implements <code>IWebContext</code></li>
</ul>
<p>And as you can see in the controller code, <code>WebContext</code> is the one we will use. In fact we have to, because the use of a <code>ServletContextTemplateResolver</code> requires that we use a context implementing <code>IWebContext</code>.</p>
<pre class="sourceCode java"><code class="sourceCode java">WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());</code></pre>
<p>Only two of those three constructor arguments is required, because the default locale for the system will be used if none is specified (although you should never let this happen in real applications).</p>
<p>From the interface definition we can tell that <code>WebContext</code> will offer specialized methods for obtaining the request parameters and request, session and application attributes . But in fact <code>WebContext</code> will do a little bit more than just that:</p>
<ul>
<li>Add all the request attributes to the context variables map.</li>
<li>Add a context variable called param containing all the request parameters.</li>
<li>Add a context variable called session containing all the session attributes.</li>
<li>Add a context variable called application containing all the ServletContext attributes.</li>
</ul>
<p>All context objects (implementations of <code>IContext</code>), including both <code>Context</code> and <code>WebContext</code>, are set a special variable just before execution called the execution info (<code>execInfo</code>). This variable contains two pieces of data that can be used from within your templates:</p>
<ul>
<li>The template name (<code>${execInfo.templateName}</code>), the name specified for engine execution, and corresponding to the template being executed.</li>
<li>The current date and time (<code>${execInfo.now}</code>), a <code>Calendar</code> object corresponding to the moment the template engine started its execution for this template.</li>
</ul>
</section>
<section id="executing-the-template-engine" class="level3">
<h3><a href="#executing-the-template-engine">Executing the template engine</a></h3>
<p>With our context object ready, all we need is executing the template engine specifying the template name and the context, and passing on the response writer so that the response can be written to it:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateEngine.<span class="fu">process</span>(<span class="st">&quot;home&quot;</span>, ctx, response.<span class="fu">getWriter</span>());</code></pre>
<p>Let's see the results of this using the Spanish locale:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/css/gtvg.css&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>
  
    <span class="kw">&lt;p&gt;</span>¡Bienvenido a nuestra tienda de comestibles!<span class="kw">&lt;/p&gt;</span>

  <span class="kw">&lt;/body&gt;</span>

<span class="kw">&lt;/html&gt;</span></code></pre>
</section>
</section>
<section id="more-on-texts-and-variables" class="level2">
<h2><a href="#more-on-texts-and-variables">3.2 More on texts and variables</a></h2>
<section id="unescaped-text" class="level3">
<h3><a href="#unescaped-text">Unescaped Text</a></h3>
<p>The simplest version of our Home page seems to be ready now, but there is something we have not thought about... what if we had a message like this?</p>
<pre class="sourceCode java"><code class="sourceCode java">home.<span class="fu">welcome</span>=Welcome to our &lt;b&gt;fantastic&lt;/b&gt; grocery store!</code></pre>
<p>If we execute this template like before, we will obtain:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Welcome to our <span class="dv">&amp;lt;</span>b<span class="dv">&amp;gt;</span>fantastic<span class="dv">&amp;lt;</span>/b<span class="dv">&amp;gt;</span> grocery store!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>Which is not exactly what we expected, because our <code>&lt;b&gt;</code> tag has been escaped and therefore it will be displayed at the browser.</p>
<p>This is the default behaviour of the th:text attribute. If we want Thymeleaf to respect our XHTML tags and not escape them, we will have to use a different attribute: <code>th:utext</code> (for &quot;unescaped text&quot;):</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span>
This will output our message just like we wanted it:
<span class="kw">&lt;p&gt;</span>Welcome to our <span class="kw">&lt;b&gt;</span>fantastic<span class="kw">&lt;/b&gt;</span> grocery store!<span class="kw">&lt;/p&gt;</span></code></pre>
</section>
<section id="using-and-displaying-variables" class="level3">
<h3><a href="#using-and-displaying-variables">Using and displaying variables</a></h3>
<p>Now let's add some more contents to our home page. For example, we could want to display the date below our welcome message, like this:</p>
<pre><code>Welcome to our fantastic grocery store!

Today is: 12 july 2010</code></pre>
<p>First of all, we will have to modify our controller so that we add that date as a context variable:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">void</span> <span class="fu">process</span>(
        HttpServletRequest request, HttpServletResponse response,
        ServletContext servletContext, TemplateEngine templateEngine) {
        
    SimpleDateFormat dateFormat = <span class="kw">new</span> SimpleDateFormat(<span class="st">&quot;dd MMMM yyyy&quot;</span>);
    Calendar cal = Calendar.<span class="fu">getInstance</span>();
        
    WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());
    ctx.<span class="fu">setVariable</span>(<span class="st">&quot;today&quot;</span>, dateFormat<span class="fu">.format</span>(cal.<span class="fu">getTime</span>()));
        
    templateEngine.<span class="fu">process</span>(<span class="st">&quot;home&quot;</span>, ctx, response.<span class="fu">getWriter</span>());
      
}</code></pre>
<p>We have added a <code>String</code> today variable to our context, and now we can display it in our template:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body&gt;</span>

  <span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span>

  <span class="kw">&lt;p&gt;</span>Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${today}&quot;</span><span class="kw">&gt;</span>13 February 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
  
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>As you can see, we are still using the <code>th:text</code> attribute for the job (and that's correct, because we want to substitute the tag's body), but the syntax is a little bit different this time and instead of a <code>#{...}</code> expression value, we are using a <code>${...}</code> one. This is a variable expression value, and it contains an expression in a language called <em>OGNL (Object-Graph Navigation Language)</em> that will be executed on the context variables map.</p>
<p>The <code>${today}</code> expression simply means &quot;get the variable called today&quot;, but these expressions could be more complex (like <code>${user.name}</code> for &quot;get the variable called user, and call its <code>getName()</code> method&quot;).</p>
<p>There are quite a lot of possibilities in attribute values: messages, variable expressions... and quite a lot more. Next chapter will show us what all these possibilities are.</p>
</section>
</section>
</section>
<section id="standard-expression-syntax" class="level1">
<h1><a href="#standard-expression-syntax">4 Standard Expression Syntax</a></h1>
<p>We will make a small break in the development of our grocery virtual store to learn about one of the most important parts of the Thymeleaf Standard Dialect: the Thymeleaf Standard Expression syntax.</p>
<p>We have already seen two types of valid attribute values expressed in this syntax: message and variable expressions:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span>

<span class="kw">&lt;p&gt;</span>Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${today}&quot;</span><span class="kw">&gt;</span>13 february 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
<p>But there are more types of value we don't know yet, and more interesting detail to know about the ones we already know. First, let's see a quick summary of the Standard Expression features:</p>
<ul>
<li>Text literals: '...'</li>
<li>Number literals: 0, 34, 12, 3.0, 12.3, etc.</li>
<li>Simple expressions:
<ul>
<li>Variable Expressions: ${...}</li>
<li>Selection Variable Expressions: *{...}</li>
<li>Message Expressions: #{...}</li>
<li>Link URL Expressions: @{...}</li>
</ul></li>
<li>Binary operations:
<ul>
<li>String concatenation: +</li>
<li>Arithmetic operators: +, -, *, /, %</li>
<li>Comparators: &gt;, &lt;, &gt;=, &lt;=</li>
<li>Boolean operators: and, or</li>
<li>Equality operators: ==, !=</li>
</ul></li>
<li>Unary operations:
<ul>
<li>Minus sign (numeric): -</li>
<li>Boolean negation: !</li>
</ul></li>
<li>Conditional operators:
<ul>
<li>If-then: (if) ? (then)</li>
<li>If-then-else: (if) ? (then) : (else)</li>
<li>Default: (value) ?: (defaultvalue)</li>
</ul></li>
</ul>
<p>All this operations can be combined and nested:</p>
<pre class="sourceCode html"><code class="sourceCode html">&#39;User is of type &#39; + (${user.isAdmin()} ? &#39;Administrator&#39; : (${user.type} ?: &#39;Unknown&#39;))</code></pre>
<section id="messages" class="level2">
<h2><a href="#messages">4.1 Messages</a></h2>
<p>As we already know, <code>#{...}</code> message expressions allow us to link this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>...to this:</p>
<pre class="sourceCode html"><code class="sourceCode html">home.welcome=¡Bienvenido a nuestra tienda de comestibles!</code></pre>
<p>But there's one aspect we still haven't thought of: what happens if the message text is not completely static? What if, for example, our application knew who is the user visiting the site at any moment and we wanted to greet him/her by name?</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>¡Bienvenido a nuestra tienda de comestibles, John Apricot!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>This means we would need to add a parameter to our message. Just like this:</p>
<pre class="sourceCode html"><code class="sourceCode html">home.welcome=¡Bienvenido a nuestra tienda de comestibles, {0}!</code></pre>
<p>Parameters are specified according to the <code>java.text.MessageFormat</code> standard syntax, which means you could add format to numbers and dates as specified in the API docs for that class.</p>
<p>In order to specify a value for our parameter, and given an HTTP session attribute called user, we would have:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome(${session.user.name})}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store, Sebastian Pepper!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>If needed, several parameters could be specified, separated by commas. In fact, the message key itself could come from a variable:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{${welcomeMsgKey}(${session.user.name})}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store, Sebastian Pepper!<span class="kw">&lt;/p&gt;</span></code></pre>
</section>
<section id="variables" class="level2">
<h2><a href="#variables">4.2 Variables</a></h2>
<p>We already mentioned that <code>${...}</code> expressions are in fact OGNL (Object-Graph Navigation Language) expressions executed on the map of variables contained in the context.</p>
<blockquote>
<p>For detailed info about OGNL syntax and features, you should read the OGNL Language Guide at: <a href="http://commons.apache.org/ognl/">http://commons.apache.org/ognl/</a></p>
</blockquote>
<p>From OGNL's syntax, we know that this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${today}&quot;</span><span class="kw">&gt;</span>13 february 2011<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span></code></pre>
<p>...is in fact equivalent to this:</p>
<pre class="sourceCode java"><code class="sourceCode java">ctx.<span class="fu">getVariables</span>().<span class="fu">get</span>(<span class="st">&quot;today&quot;</span>);</code></pre>
<p>But OGNL allows us to create quite more powerful expressions, and that's how this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:utext=</span><span class="st">&quot;#{home.welcome(${session.user.name})}&quot;</span><span class="kw">&gt;</span>Welcome to our grocery store, Sebastian Pepper!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>...does in fact obtain the user name by executing:</p>
<pre class="sourceCode java"><code class="sourceCode java">((User) ctx.<span class="fu">getVariables</span>().<span class="fu">get</span>(<span class="st">&quot;session&quot;</span>).<span class="fu">get</span>(<span class="st">&quot;user&quot;</span>)).<span class="fu">getName</span>();</code></pre>
<p>But getter method navigation is just one of OGNL's features. Let's see some more:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * Access to properties using the point (.). Equivalent to calling property getters.</span>
<span class="co"> */</span>
${person.<span class="fu">father</span>.<span class="fu">name</span>}

<span class="co">/*</span>
<span class="co"> * Access to properties can also be made by using brackets ([]) and writing </span>
<span class="co"> * the name of the property as a variable or between single quotes.</span>
<span class="co"> */</span>
${person[&#39;father&#39;][&#39;name&#39;]}

<span class="co">/*</span>
<span class="co"> * If the object is a map, both dot and bracket syntax will be equivalent to </span>
<span class="co"> * executing a call on its get(...) method.</span>
<span class="co"> */</span>
${countriesByCode.<span class="fu">ES</span>}
${personsByName[&#39;Stephen Zucchini&#39;].<span class="fu">age</span>}

<span class="co">/*</span>
<span class="co"> * Indexed access to arrays or collections is also performed with brackets, </span>
<span class="co"> * writing the index without quotes.</span>
<span class="co"> */</span>
${personsArray[<span class="dv">0</span>].<span class="fu">name</span>}

<span class="co">/*</span>
<span class="co"> * Methods can be called, even with arguments.</span>
<span class="co"> */</span>
${person.<span class="fu">createCompleteName</span>()}
${person.<span class="fu">createCompleteNameWithSeparator</span>(&#39;-&#39;)}</code></pre>
<section id="expression-basic-objects" class="level3">
<h3><a href="#expression-basic-objects">Expression basic objects</a></h3>
<p>When evaluating OGNL expressions on the context variables, some objects are made available to expressions for higher flexibility. These objects will be referenced (per OGNL standard) starting with the <code>#</code> symbol:</p>
<ul>
<li><code>#ctx</code>: the context object</li>
<li><code>#root</code> or <code>#vars: the context variables objects, against which unqualified    expressions are evaluated (usually the variables contained in</code>#ctx.variables` plus local ones)</li>
<li><code>#locale</code>: the context locale</li>
<li><code>#httpServletRequest</code>: (only in Web Contexts) the <code>HttpServletRequest</code> object.</li>
<li><code>#httpSession</code>: (only in Web Contexts) the <code>HttpSession</code> object.</li>
</ul>
<p>So we can do this:</p>
<pre class="sourceCode html"><code class="sourceCode html">Established locale country: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#locale.country}&quot;</span><span class="kw">&gt;</span>US<span class="kw">&lt;/span&gt;</span>.</code></pre>
</section>
<section id="expression-utility-objects" class="level3">
<h3><a href="#expression-utility-objects">Expression utility objects</a></h3>
<p>Besides these basic objects, Thymeleaf will offer us a set of utility objects that will help us perform common tasks in our expressions.</p>
<ul>
<li><code>#dates</code>: utility methods for <code>java.util.Date</code> objects: formatting, component extraction, etc.</li>
<li><code>#calendars</code>: analogous to <code>#dates</code>, but for <code>java.util.Calendar</code> objects.</li>
<li><code>#numbers</code>: utility methods for formatting numeric objects.</li>
<li><code>#strings</code>: utility methods for <code>String</code> objects: contains, startsWith, prepending/appending, etc.</li>
<li><code>#objects</code>: utility methods for objects in general.</li>
<li><code>#bools</code>: utility methods for boolean evaluation.</li>
<li><code>#arrays</code>: utility methods for arrays.</li>
<li><code>#lists</code>: utility methods for lists.</li>
<li><code>#sets</code>: utility methods for sets.</li>
<li><code>#maps</code>: utility methods for maps.</li>
<li><code>#aggregates</code>: utility methods for creating aggregates on arrays or collections.</li>
<li><code>#messages</code>: utility methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using #{...} syntax.</li>
<li><code>#ids</code>: utility methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).</li>
</ul>
<p>You can check what functions are offered by each of these utility objects in the <a href="appendix-expression-utility-objects">Appendix</a>.</p>
</section>
<section id="reformatting-dates-in-our-home-page" class="level3">
<h3><a href="#reformatting-dates-in-our-home-page">Reformatting dates in our home page</a></h3>
<p>Now we know about these utility objects, we could use them to change the way in which we show the date in our home page. Instead of doing this in our <code>HomeController</code>:</p>
<pre class="sourceCode java"><code class="sourceCode java">SimpleDateFormat dateFormat = <span class="kw">new</span> SimpleDateFormat(<span class="st">&quot;dd MMMM yyyy&quot;</span>);
Calendar cal = Calendar.<span class="fu">getInstance</span>();

WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());
ctx.<span class="fu">setVariable</span>(<span class="st">&quot;today&quot;</span>, dateFormat<span class="fu">.format</span>(cal.<span class="fu">getTime</span>()));

templateEngine.<span class="fu">process</span>(<span class="st">&quot;home&quot;</span>, ctx, response.<span class="fu">getWriter</span>());</code></pre>
<p>...we can do just this:</p>
<pre class="sourceCode java"><code class="sourceCode java">WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());
ctx.<span class="fu">setVariable</span>(<span class="st">&quot;today&quot;</span>, Calendar.<span class="fu">getInstance</span>());

templateEngine.<span class="fu">process</span>(<span class="st">&quot;home&quot;</span>, ctx, response.<span class="fu">getWriter</span>());</code></pre>
<p>...and then perform date formatting in the view layer itself:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#calendars.format(today,&#39;dd MMMM yyyy&#39;)}&quot;</span><span class="kw">&gt;</span>13 February 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
</section>
</section>
<section id="expressions-on-selections-asterisk-syntax" class="level2">
<h2><a href="#expressions-on-selections-asterisk-syntax">4.3 Expressions on selections (asterisk syntax)</a></h2>
<p>Variable expressions not only can be written in <code>${...}</code> expressions, but also in <code>*{...}</code> ones.</p>
<p>There is an important difference, though: the asterisk syntax evaluates expressions on selected objects rather than on the whole context variables map. This is, unless a selection has not been yet performed, in which case the dollar and the asterisk syntaxes do exactly the same.</p>
<p>And what is that object selection thing? A <code>th:object</code> attribute. Let's use it in our user profile (<code>userprofile.html</code>) page:</p>
<pre class="sourceCode html"><code class="sourceCode html">  <span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;${session.user}&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{firstName}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;p&gt;</span>Surname: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{lastName}&quot;</span><span class="kw">&gt;</span>Pepper<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;p&gt;</span>Nationality: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{nationality}&quot;</span><span class="kw">&gt;</span>Saturn<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;/div&gt;</span></code></pre>
<p>Which is exactly equivalent to:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div&gt;</span>
  <span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.firstName}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Surname: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.lastName}&quot;</span><span class="kw">&gt;</span>Pepper<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Nationality: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.nationality}&quot;</span><span class="kw">&gt;</span>Saturn<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>Of course, dollar and asterisk syntax can be mixed:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;${session.user}&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{firstName}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Surname: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.lastName}&quot;</span><span class="kw">&gt;</span>Pepper<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Nationality: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{nationality}&quot;</span><span class="kw">&gt;</span>Saturn<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>When an object selection is in place, the selected object will be also available to dollar expressions as the <code>#object</code> expression variable:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;${session.user}&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#object.firstName}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Surname: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.lastName}&quot;</span><span class="kw">&gt;</span>Pepper<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Nationality: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{nationality}&quot;</span><span class="kw">&gt;</span>Saturn<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>As said, if no object selection has been performed, dollar and asterisk syntaxes are exactly equivalent.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div&gt;</span>
  <span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{session.user.name}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Surname: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{session.user.surname}&quot;</span><span class="kw">&gt;</span>Pepper<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p&gt;</span>Nationality: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{session.user.nationality}&quot;</span><span class="kw">&gt;</span>Saturn<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
</section>
<section id="link-urls" class="level2">
<h2><a href="#link-urls">4.4 Link URLs</a></h2>
<p>Because of their importance, URLs are first-class citizens in web application templates, and the <em>Thymeleaf Standard Dialect</em> has a special syntax for them, the <code>@</code> syntax: <code>@{...}</code></p>
<p>There are different types of URLs:</p>
<ul>
<li>Absolute URLs, like <code>http://www.thymeleaf.org</code></li>
<li>Relative URLs, which can be:
<ul>
<li>Page-relative, like <code>user/login.html</code></li>
<li>Context-relative, like <code>/itemdetails?id=3</code> (context name in server will be added automatically)</li>
<li>Server-relative, like <code>~/billing/processInvoice</code> (allows calling URLs in another context (= application) in the same server.</li>
</ul></li>
</ul>
<p>Thymeleaf can handle absolute URLs in any situation, but for relative ones it will require you to use a context object that implements the <code>IWebContext</code> interface, which contains some info coming from the HTTP request and needed to create relative links.</p>
<p>Let's use this new syntax. Meet the <code>th:href</code> attribute:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;details.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{http://localhost:8080/gtvg/order/details(orderId=${o.id})}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>

<span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;details.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/order/details(orderId=${o.id})}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span></code></pre>
<p>Some things to note here:</p>
<ul>
<li><code>th:href</code> is an attribute modifier attribute: once processed, it will compute the link URL to be used and set the href attribute of the <code>&lt;a&gt;</code> tag to this URL.</li>
<li>We are allowed to use expressions for URL parameters (as you can see in <code>orderId=${o.id}</code>). The required URL-encoding operations will also be automatically performed.</li>
<li>If several parameters are needed, these will be separated by commas like <code>@{/order/process(execId=${execId},execType='FAST')}</code></li>
<li>Relative URLs starting with <code>/</code> (like <code>/order/details</code>) will be automatically prefixed the application context name.</li>
<li>If cookies are not enabled or this is not yet known, Thymeleaf will add a <code>&quot;;jsessionid=...&quot;</code> suffix to relative URLs so that session is preserved. This is called <em>URL Rewriting</em>.</li>
<li>The <code>th:href</code> tag allowed us to (optionally) have a working static href attribute in our template, so that our template links remained navigable by a browser when opened directly for prototyping purposes.</li>
</ul>
<p>As was the case with the message syntax (<code>#{...}</code>), URL bases can also be the result of evaluating another expression:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> th:href=</span><span class="st">&quot;@{${url}(orderId=${o.id})}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
<span class="kw">&lt;a</span><span class="ot"> th:href=</span><span class="st">&quot;@{&#39;/details/&#39;+${user.login}(orderId=${o.id})}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span></code></pre>
<section id="a-menu-for-our-home-page" class="level3">
<h3><a href="#a-menu-for-our-home-page">A menu for our home page</a></h3>
<p>Now we know how to create link URLs, what about adding a small menu in our home for some of the other pages in the site?</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Please select an option<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;ol&gt;</span>
  <span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&quot;product/list.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/product/list}&quot;</span><span class="kw">&gt;</span>Product List<span class="kw">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&quot;order/list.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/order/list}&quot;</span><span class="kw">&gt;</span>Order List<span class="kw">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&quot;subscribe.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/subscribe}&quot;</span><span class="kw">&gt;</span>Subscribe to our Newsletter<span class="kw">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&quot;userprofile.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/userprofile}&quot;</span><span class="kw">&gt;</span>See User Profile<span class="kw">&lt;/a&gt;&lt;/li&gt;</span>
<span class="kw">&lt;/ol&gt;</span></code></pre>
</section>
</section>
<section id="literals" class="level2">
<h2><a href="#literals">4.5 Literals</a></h2>
<p>Literals are a type of value extremely simple to understand. There are two types: text and numeric.</p>
<p>Text literals are just character strings specified between single quotes:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Now you are looking at a <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;&#39;working web application&#39;&quot;</span><span class="kw">&gt;</span>template file<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
As for numeric literals, they are simply numbers:
<span class="kw">&lt;p&gt;</span>The year is <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;2011&quot;</span><span class="kw">&gt;</span>1492<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;p&gt;</span>In two years, it will be <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;2011 + 2&quot;</span><span class="kw">&gt;</span>1494<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span></code></pre>
</section>
<section id="concatenating-texts" class="level2">
<h2><a href="#concatenating-texts">4.6 Concatenating texts</a></h2>
<p>Texts, no matter whether they are literals or the result of evaluating variable or message expressions, can be easily concatenated using the <code>+</code> operator:</p>
<pre class="sourceCode html"><code class="sourceCode html">th:text=&quot;&#39;The name of the user is &#39; + ${user.name}&quot;</code></pre>
</section>
<section id="arithmetic-operations" class="level2">
<h2><a href="#arithmetic-operations">4.7 Arithmetic operations</a></h2>
<p>Some arithmetic operations are also available: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>%</code>.</p>
<pre class="sourceCode html"><code class="sourceCode html">th:with=&quot;isEven=(${prodStat.count} % 2 == 0)&quot;</code></pre>
<p>Note that this operators can also be applied inside OGNL variable expressions themselves (and in that case will be executed by OGNL instead of the Thymeleaf Standard Expression engine):</p>
<pre class="sourceCode html"><code class="sourceCode html">th:with=&quot;isEven=${prodStat.count % 2 == 0}&quot;</code></pre>
</section>
<section id="comparators-and-equality" class="level2">
<h2><a href="#comparators-and-equality">4.8 Comparators and Equality</a></h2>
<p>Values in expressions can be compared with the <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> and <code>&lt;=</code> symbols, as usual, and also the <code>==</code> and <code>!=</code> operators can be used to check equality (or the lack of it). Note that XML establishes that the <code>&lt;</code> and <code>&gt;</code> symbols should not be used in attribute values, and so they should be substituted by <code>&amp;lt;</code> and <code>&amp;gt;</code>.</p>
<pre class="sourceCode html"><code class="sourceCode html">th:if=&quot;${prodStat.count} gt; 1&quot;
th:text=&quot;&#39;Execution mode is &#39; + ( (${execMode} == &#39;dev&#39;)? &#39;Development&#39; : &#39;Production&#39;)&quot;</code></pre>
<p>Note that textual aliases exist for these operators: <code>gt</code> (<code>&gt;</code>), <code>lt</code> (<code>&lt;</code>), <code>ge</code> (<code>&gt;=</code>) and <code>le</code> (<code>&lt;=</code>). Also <code>eq</code> (<code>==</code>) and <code>neq</code> (<code>!=</code>).</p>
</section>
<section id="conditional-expressions" class="level2">
<h2><a href="#conditional-expressions">4.9 Conditional expressions</a></h2>
<p><em>Conditional expressions</em> are meant to evaluate only one of two expressions depending on the result of evaluating a condition (which is itself another expression).</p>
<p>Let's have a look at an example fragment (introducing another <em>attribute modifier</em>, this time <code>th:class</code>):</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;tr</span><span class="ot"> th:class=</span><span class="st">&quot;${row.even}? &#39;even&#39; : &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
  ...
<span class="kw">&lt;/tr&gt;</span></code></pre>
<p>All three parts of a conditional expression (<code>condition</code>, <code>then</code> and <code>else</code>) are themselves expressions, which means that they can be variables (<code>${...}</code>, <code>*{...}</code>), messages (<code>#{...}</code>), URLs (<code>@{...}</code>) or literals (<code>'...'</code>).</p>
<p>Conditional expressions can also be nested using parentheses:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;tr</span><span class="ot"> th:class=</span><span class="st">&quot;${row.even}? (${row.first}? &#39;first&#39; : &#39;even&#39;) : &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
  ...
<span class="kw">&lt;/tr&gt;</span></code></pre>
<p>Else expressions can also be omitted, in which case a null value is returned if the condition is false:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;tr</span><span class="ot"> th:class=</span><span class="st">&quot;${row.even}? &#39;alt&#39;&quot;</span><span class="kw">&gt;</span>
  ...
<span class="kw">&lt;/tr&gt;</span></code></pre>
</section>
<section id="default-expressions-elvis-operator" class="level2">
<h2><a href="#default-expressions-elvis-operator">4.10 Default expressions (Elvis operator)</a></h2>
<p>A <em>default expression</em> is a special kind of conditional value without a <em>then</em> part. It is equivalent to the <em>Elvis operator</em> present in some languages like Groovy, and allows to specify two expressions, being the second one evaluated only in the case of the first one returning null.</p>
<p>Let's see it in action in our user profile page:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;${session.user}&quot;</span><span class="kw">&gt;</span>
  ...
  <span class="kw">&lt;p&gt;</span>Age: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{age}?: &#39;(no age specified)&#39;&quot;</span><span class="kw">&gt;</span>27<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>As you can see, the operator is <code>?:</code>, and we use it here to specify a default value for a name (a literal value, in this case) only if the result of evaluating <code>*{age}</code> is null. This is therefore equivalent to:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Age: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{age != null}? *{age} : &#39;(no age specified)&#39;&quot;</span><span class="kw">&gt;</span>27<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span></code></pre>
<p>As with conditional values, they can contain nested expressions between parentheses:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Name: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{firstName}?: (*{admin}? &#39;Admin&#39; : #{default.username})&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span></code></pre>
</section>
<section id="preprocessing" class="level2">
<h2><a href="#preprocessing">4.11 Preprocessing</a></h2>
<p>In addition to all these features for expression processing, Thymeleaf offers to us the possibility of <em>preprocessing</em> expressions.</p>
<p>And what is that preprocessing thing? It is an execution of the expressions done before the normal one, that allows the modification of the actual expression that will be eventually executed.</p>
<p>Preprocessed expressions are exactly like normal ones, but appear surrounded by a double underscore symbol (like <code>__${expression}__</code>).</p>
<p>Let's imagine we have an i18n <code>Messages_fr.properties</code> entry containing an OGNL expression calling a language-specific static method, like:</p>
<pre class="sourceCode java"><code class="sourceCode java">article.<span class="fu">text</span>=<span class="fu">@myapp</span>.<span class="fu">translator</span>.<span class="fu">Translator@translateToFrench</span>({<span class="dv">0</span>})</code></pre>
<p>...and a <code>Messages_es.properties equivalent</code>:</p>
<pre class="sourceCode java"><code class="sourceCode java">article.<span class="fu">text</span>=<span class="fu">@myapp</span>.<span class="fu">translator</span>.<span class="fu">Translator@translateToSpanish</span>({<span class="dv">0</span>})</code></pre>
<p>We can create a fragment of markup that evaluates one expression or the other depending on the locale. For this, we will first select the expression (by preprocessing) and then let Thymeleaf execute it:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:text=</span><span class="st">&quot;${__#{article.text(&#39;textVar&#39;)}__}&quot;</span><span class="kw">&gt;</span>Some text here...<span class="kw">&lt;/p&gt;</span></code></pre>
<p>Note that the preprocessing step for a French locale will be creating the following equivalent:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:text=</span><span class="st">&quot;${@myapp.translator.Translator@translateToFrench(textVar)}&quot;</span><span class="kw">&gt;</span>Some text here...<span class="kw">&lt;/p&gt;</span></code></pre>
</section>
</section>
<section id="setting-attribute-values" class="level1">
<h1><a href="#setting-attribute-values">5 Setting attribute values</a></h1>
<p>This chapter will explain the way in which we can set (or modify) values of attributes in our markup tags, possibly the next most basic feature we will need after setting the tag body content.</p>
<section id="setting-the-value-of-any-attribute" class="level2">
<h2><a href="#setting-the-value-of-any-attribute">5.1 Setting the value of any attribute</a></h2>
<p>Say our website publishes a newsletter, and we want our users to be able to subscribe to it, so we create a <code>/WEB-INF/templates/subscribe.html</code> template with a form:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&quot;subscribe.html&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;fieldset&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> name=</span><span class="st">&quot;email&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;submit&quot;</span><span class="ot"> value=</span><span class="st">&quot;Subscribe me!&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/fieldset&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>It looks quite OK, but the fact is that this file looks more like a static XHTML page than a template for a web application. First, the action attribute in our form statically links to the template file itself, so that there is no place for useful URL rewriting. Second, the value attribute in the submit button makes it display a text in English, but we'd like it to be internationalized.</p>
<p>Enter then the <code>th:attr</code> attribute, and its ability to change the value of attributes of the tags it is set in:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&quot;subscribe.html&quot;</span><span class="ot"> th:attr=</span><span class="st">&quot;action=@{/subscribe}&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;fieldset&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> name=</span><span class="st">&quot;email&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;submit&quot;</span><span class="ot"> value=</span><span class="st">&quot;Subscribe me!&quot;</span><span class="ot"> th:attr=</span><span class="st">&quot;value=#{subscribe.submit}&quot;</span><span class="kw">/&gt;</span>
  <span class="kw">&lt;/fieldset&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>The concept is quite straightforward: <code>th:attr</code> simply takes an expression that assigns a value to an attribute. Having created the corresponding controller and messages files, the result of processing this file will be as expected:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&quot;/gtvg/subscribe&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;fieldset&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> name=</span><span class="st">&quot;email&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;submit&quot;</span><span class="ot"> value=</span><span class="st">&quot;¡Suscríbeme!&quot;</span><span class="kw">/&gt;</span>
  <span class="kw">&lt;/fieldset&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>Besides the new attribute values, you can also see that the applicacion context name has been automatically prefixed to the URL base in <code>/gtvg/subscribe</code>, as explained in the previous chapter.</p>
<p>But what if we wanted to set more than one attribute at a time? XML rules do not allow you to set an attribute twice in a tag, so <code>th:attr</code> will take a comma-separated list of assignations, like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;../../images/gtvglogo.png&quot;</span><span class="ot"> th:attr=</span><span class="st">&quot;src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>Given the required messages files, this will output:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;/gtgv/images/gtvglogo.png&quot;</span><span class="ot"> title=</span><span class="st">&quot;Logo de Good Thymes&quot;</span><span class="ot"> alt=</span><span class="st">&quot;Logo de Good Thymes&quot;</span> <span class="kw">/&gt;</span></code></pre>
</section>
<section id="setting-value-to-specific-attributes" class="level2">
<h2><a href="#setting-value-to-specific-attributes">5.2 Setting value to specific attributes</a></h2>
<p>By now, you might be thinking that something like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;submit&quot;</span><span class="ot"> value=</span><span class="st">&quot;Subscribe me!&quot;</span><span class="ot"> th:attr=</span><span class="st">&quot;value=#{subscribe.submit}&quot;</span><span class="kw">/&gt;</span></code></pre>
<p>...is quite an ugly piece of markup. Specifying an assignation inside an attribute's value can be very practical, but it is not the most elegant way of creating templates if you have to do it all the time.</p>
<p>Thymeleaf agrees with you. And that's why in fact <code>th:attr</code> is scarcely used in templates. Normally, you will be using other <code>th:*</code> attributes which task is setting specific tag attributes (and not just any attribute like <code>th:attr</code>).</p>
<p>And which attribute does the Standard Dialect offer us for setting the <code>value</code> attribute of our button? Well, in a rather obvious manner, it' `th:value. Let's have a look:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;submit&quot;</span><span class="ot"> value=</span><span class="st">&quot;Subscribe me!&quot;</span><span class="ot"> th:value=</span><span class="st">&quot;#{subscribe.submit}&quot;</span><span class="kw">/&gt;</span></code></pre>
<p>This looks much better!. Let's try and do the same to the <code>action</code> attribute in the <code>form</code> tag:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&quot;subscribe.html&quot;</span><span class="ot"> th:action=</span><span class="st">&quot;@{/subscribe}&quot;</span><span class="kw">&gt;</span></code></pre>
<p>And do you remember those <code>th:href</code> we put in our <code>home.html</code> before? They are exactly this same kind of attributes:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&quot;product/list.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/product/list}&quot;</span><span class="kw">&gt;</span>Product List<span class="kw">&lt;/a&gt;&lt;/li&gt;</span></code></pre>
<p>There are quite a lot of attributes like these, each of them targeting a specific XHTML or HTML5 attribute:</p>
<table>
  <tr>
    <td>
<code>th:abbr</code>
</td>
    <td>
<code>th:accept</code>
</td>
    <td>
<code>th:accept-charset</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:accesskey</code>
</td>
    <td>
<code>th:action</code>
</td>
    <td>
<code>th:align</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:alt</code>
</td>
    <td>
<code>th:archive</code>
</td>
    <td>
<code>th:audio</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:autocomplete</code>
</td>
    <td>
<code>th:axis</code>
</td>
    <td>
<code>th:background</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:bgcolor</code>
</td>
    <td>
<code>th:border</code>
</td>
    <td>
<code>th:cellpadding</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:cellspacing</code>
</td>
    <td>
<code>th:challenge</code>
</td>
    <td>
<code>th:charset</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:cite</code>
</td>
    <td>
<code>th:class</code>
</td>
    <td>
<code>th:classid</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:codebase</code>
</td>
    <td>
<code>th:codetype</code>
</td>
    <td>
<code>th:cols</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:colspan</code>
</td>
    <td>
<code>th:compact</code>
</td>
    <td>
<code>th:content</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:contenteditable</code>
</td>
    <td>
<code>th:contextmenu</code>
</td>
    <td>
<code>th:data</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:datetime</code>
</td>
    <td>
<code>th:dir</code>
</td>
    <td>
<code>th:draggable</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:dropzone</code>
</td>
    <td>
<code>th:enctype</code>
</td>
    <td>
<code>th:for</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:form</code>
</td>
    <td>
<code>th:formaction</code>
</td>
    <td>
<code>th:formenctype</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:formmethod</code>
</td>
    <td>
<code>th:formtarget</code>
</td>
    <td>
<code>th:frame</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:frameborder</code>
</td>
    <td>
<code>th:headers</code>
</td>
    <td>
<code>th:height</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:high</code>
</td>
    <td>
<code>th:href</code>
</td>
    <td>
<code>th:hreflang</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:hspace</code>
</td>
    <td>
<code>th:http-equiv</code>
</td>
    <td>
<code>th:icon</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:id</code>
</td>
    <td>
<code>th:keytype</code>
</td>
    <td>
<code>th:kind</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:label</code>
</td>
    <td>
<code>th:lang</code>
</td>
    <td>
<code>th:list</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:longdesc</code>
</td>
    <td>
<code>th:low</code>
</td>
    <td>
<code>th:manifest</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:marginheight</code>
</td>
    <td>
<code>th:marginwidth</code>
</td>
    <td>
<code>th:max</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:maxlength</code>
</td>
    <td>
<code>th:media</code>
</td>
    <td>
<code>th:method</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:min</code>
</td>
    <td>
<code>th:name</code>
</td>
    <td>
<code>th:optimum</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:pattern</code>
</td>
    <td>
<code>th:placeholder</code>
</td>
    <td>
<code>th:poster</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:preload</code>
</td>
    <td>
<code>th:radiogroup</code>
</td>
    <td>
<code>th:rel</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:rev</code>
</td>
    <td>
<code>th:rows</code>
</td>
    <td>
<code>th:rowspan</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:rules</code>
</td>
    <td>
<code>th:sandbox</code>
</td>
    <td>
<code>th:scheme</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:scope</code>
</td>
    <td>
<code>th:scrolling</code>
</td>
    <td>
<code>th:size</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:sizes</code>
</td>
    <td>
<code>th:span</code>
</td>
    <td>
<code>th:spellcheck</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:src</code>
</td>
    <td>
<code>th:srclang</code>
</td>
    <td>
<code>th:standby</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:start</code>
</td>
    <td>
<code>th:step</code>
</td>
    <td>
<code>th:style</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:summary</code>
</td>
    <td>
<code>th:tabindex</code>
</td>
    <td>
<code>th:target</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:title</code>
</td>
    <td>
<code>th:type</code>
</td>
    <td>
<code>th:usemap</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:value</code>
</td>
    <td>
<code>th:valuetype</code>
</td>
    <td>
<code>th:vspace</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:width</code>
</td>
    <td>
<code>th:wrap</code>
</td>
    <td>
<code>th:xmlbase</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:xmllang</code>
</td>
    <td>
<code>th:xmlspace</code>
</td>
    <td></td>
  </tr>
</table>



</section>
<section id="setting-more-than-one-value-at-a-time" class="level2">
<h2><a href="#setting-more-than-one-value-at-a-time">5.3 Setting more than one value at a time</a></h2>
<p>There are two rather special attributes called <code>th:alt-title</code> and <code>th:lang-xmllang</code> which can be used for setting two attributes to the same value at the same time. Specifically:</p>
<ul>
<li><code>th:alt-title</code> will set <code>alt</code> and <code>title</code>.</li>
<li><code>th:lang-xmllang</code> will set <code>lang</code> and <code>xml:lang</code>.</li>
</ul>
<p>For our GTVG home page, this will allow us to substitute this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;../../images/gtvglogo.png&quot;</span><span class="ot"> th:attr=</span><span class="st">&quot;src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>...or this, which is equivalent:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;../../images/gtvglogo.png&quot;</span><span class="ot"> th:src=</span><span class="st">&quot;@{/images/gtvglogo.png}&quot;</span><span class="ot"> th:title=</span><span class="st">&quot;#{logo}&quot;</span><span class="ot"> th:alt=</span><span class="st">&quot;#{logo}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>...by this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;../../images/gtvglogo.png&quot;</span><span class="ot"> th:src=</span><span class="st">&quot;@{/images/gtvglogo.png}&quot;</span><span class="ot"> th:alt-title=</span><span class="st">&quot;#{logo}&quot;</span> <span class="kw">/&gt;</span></code></pre>
</section>
<section id="appending-and-prepending" class="level2">
<h2><a href="#appending-and-prepending">5.4 Appending and prepending</a></h2>
<p>Working in an equivalent way to <code>th:attr</code>, Thymeleaf offers the <code>th:attrappend</code> and <code>th:attrprepend</code> attributes, which append (sufix) or prepend (prefix) the result of their evaluation to the existing attribute values.</p>
<p>For example, you might want to store the name of a CSS class to be added (not set, just added) to one of your buttons in a context variable, because the specific CSS class to be used would depend on something that the user did before. Easy:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> value=</span><span class="st">&quot;Do it!&quot;</span><span class="ot"> class=</span><span class="st">&quot;btn&quot;</span><span class="ot"> th:attrappend=</span><span class="st">&quot;class=${&#39; &#39; + cssStyle}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>If you process this template with the <code>cssStyle</code> variable set to <code>&quot;warning&quot;</code>, you will get:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> value=</span><span class="st">&quot;Do it!&quot;</span><span class="ot"> class=</span><span class="st">&quot;btn warning&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>There is also a specific <em>appending attribute</em> in the Standard Dialect: the <code>th:classappend</code> attribute, which is used for adding a CSS class to an element without overwriting the existing ones:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> class=</span><span class="st">&quot;row&quot;</span><span class="ot"> th:classappend=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span></code></pre>
<p>(Don't worry about that <code>th:each</code> attribute. It is an <em>iterating attribute</em> and will talk about it later.)</p>
</section>
<section id="fixed-value-boolean-attributes" class="level2">
<h2><a href="#fixed-value-boolean-attributes">5.5 Fixed-value boolean attributes</a></h2>
<p>Some XHTML/HTML5 attributes are special in that, either they are present in their elements with a specific and fixed value, or they are not present at all.</p>
<p>For example, <code>checked</code>:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="ot"> name=</span><span class="st">&quot;option1&quot;</span><span class="ot"> checked=</span><span class="st">&quot;checked&quot;</span> <span class="kw">/&gt;</span>
<span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="ot"> name=</span><span class="st">&quot;option2&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>No other value than <code>&quot;checked&quot;</code> is allowed according to the XHTML standards for the <code>checked</code> attribute (HTML5 rules are a little more relaxed on that). And the same happens with <code>disabled</code>, <code>multiple</code>, <code>readonly</code> and <code>selected</code>.</p>
<p>The Standard Dialect includes attributes that allow you to set these attributes by evaluating a condition, so that if evaluated to true, the attribute will be set to its fixed value, and if evaluated to false, the attribute will not be set:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="ot"> name=</span><span class="st">&quot;active&quot;</span><span class="ot"> th:checked=</span><span class="st">&quot;${user.active}&quot;</span> <span class="kw">/&gt;</span></code></pre>
<p>The following fixed-value boolean attributes exist in the Standard Dialect:</p>
<table>
  <tr>
    <td>
<code>th:async</code>
</td>
    <td>
<code>th:autofocus</code>
</td>
    <td>
<code>th:autoplay</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:checked</code>
</td>
    <td>
<code>th:controls</code>
</td>
    <td>
<code>th:declare</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:default</code>
</td>
    <td>
<code>th:defer</code>
</td>
    <td>
<code>th:disabled</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:formnovalidate</code>
</td>
    <td>
<code>th:hidden</code>
</td>
    <td>
<code>th:ismap</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:loop</code>
</td>
    <td>
<code>th:multiple</code>
</td>
    <td>
<code>th:novalidate</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:nowrap</code>
</td>
    <td>
<code>th:open</code>
</td>
    <td>
<code>th:pubdate</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:readonly</code>
</td>
    <td>
<code>th:required</code>
</td>
    <td>
<code>th:reversed</code>
</td>
  </tr>
  <tr>
    <td>
<code>th:scoped</code>
</td>
    <td>
<code>th:seamless</code>
</td>
    <td>
<code>th:selected</code>
</td>
  </tr>
</table>




</section>
</section>
<section id="iteration" class="level1">
<h1><a href="#iteration">6 Iteration</a></h1>
<p>So far we have created a home page, a user profile page and also a page for letting users subscribe to our newsletter... but what about our products? Shouldn't we build a product list to let visitors know what we sell? Well, obviously yes. And there we go now.</p>
<section id="iteration-basics" class="level2">
<h2><a href="#iteration-basics">6.1 Iteration basics</a></h2>
<p>For listing our products in our <code>/WEB-INF/templates/product/list.html</code> page we will need a table. Each of our products will be displayed in a row (a <code>&lt;tr&gt;</code> element), and so for our template we will need to create a <em>template row</em> –one that will exemplify how we want each product to be displayed– and then instruct Thymeleaf to <em>iterate it</em> once for each product.</p>
<p>The Standard Dialect offers us an attribute for exactly that, <code>th:each</code>.</p>
<section id="using-theach" class="level3">
<h3><a href="#using-theach">Using th:each</a></h3>
<p>For our product list page, we will need a controller that retrieves the list of products from the service layer and adds it to the template context:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">void</span> <span class="fu">process</span>(
        HttpServletRequest request, HttpServletResponse response,
        ServletContext servletContext, TemplateEngine templateEngine) {

    ProductService productService = <span class="kw">new</span> <span class="fu">ProductService</span>();
    List&lt;Product&gt; allProducts = productService.<span class="fu">findAll</span>(); 

    WebContext ctx = <span class="kw">new</span> <span class="fu">WebContext</span>(request, servletContext, request.<span class="fu">getLocale</span>());
    ctx.<span class="fu">setVariable</span>(<span class="st">&quot;prods&quot;</span>, allProducts);

    templateEngine.<span class="fu">process</span>(<span class="st">&quot;product/list&quot;</span>, ctx, response.<span class="fu">getWriter</span>());
}</code></pre>
<p>And then we will use <code>th:each</code> in our template to iterate the list of products:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span> 
<span class="er">          href</span><span class="ot">=</span><span class="st">&quot;../../../css/gtvg.css&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/css/gtvg.css}&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>

    <span class="kw">&lt;h1&gt;</span>Product list<span class="kw">&lt;/h1&gt;</span>
  
    <span class="kw">&lt;table&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/table&gt;</span>
  
    <span class="kw">&lt;p&gt;</span>
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;../home.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/}&quot;</span><span class="kw">&gt;</span>Return to home<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/p&gt;</span>

  <span class="kw">&lt;/body&gt;</span>

<span class="kw">&lt;/html&gt;</span></code></pre>
<p>That <code>prod : ${prods}</code> attribute value you see above means &quot;for each element in the result of evaluating <code>${prods}</code>, repeat this fragment of template setting that element into a variable called prod&quot;. Let's give a name each of the things we see:</p>
<ul>
<li>We will call <code>${prods}</code> the <em>iterated expression</em> or <em>iterated variable</em>.</li>
<li>We will call <code>prod</code> the <em>iteration variable</em> or simply <em>iter variable</em>.</li>
</ul>
<p>Note that the <code>prod</code> iter variable will only be available inside the <code>&lt;tr&gt;</code> element (including inner tags like <code>&lt;td&gt;</code>).</p>
</section>
<section id="iterable-values" class="level3">
<h3><a href="#iterable-values">Iterable values</a></h3>
<p>Not only <code>java.util.List</code> objects can be used for iteration in Thymeleaf. In fact, there is a quite complete set of objects that are considered <em>iterable</em> by a <code>th:each</code> attribute:</p>
<ul>
<li>Any object implementing <code>java.util.Iterable</code></li>
<li>Any object implementing <code>java.util.Map</code>. When iterating maps, iter variables will be of class <code>java.util.Map.Entry</code>.</li>
<li>Any array</li>
<li>Any other object will be treated as if it were a single-valued list containing the object itself.</li>
</ul>
</section>
</section>
<section id="keeping-iteration-status" class="level2">
<h2><a href="#keeping-iteration-status">6.2 Keeping iteration status</a></h2>
<p>When using <code>th:each,</code> Thymeleaf offers a mechanism useful for keeping track of the status of your iteration: the <em>status variable</em>.</p>
<p>Status variables are defined within a <code>th:each</code> attribute and contain the following data:</p>
<ul>
<li>The current <em>iteration index</em>, starting with 0. This is the <code>index</code> property.</li>
<li>The current <em>iteration index</em>, starting with 1. This is the <code>count</code> property.</li>
<li>The total amount of elements in the iterated variable. This is the <code>size</code> property.</li>
<li>The <em>iter variable</em> for each iteration. This is the <code>current</code> property.</li>
<li>Whether the current iteration is even or odd. This are the <code>even/odd</code> boolean properties.</li>
<li>Whether the current iteration is the first one. This is the <code>first</code> boolean property.</li>
<li>Whether the current iteration is the last one. This is the <code>last</code> boolean property.</li>
</ul>
<p>Let's see how we could use it within the previous example:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod,iterStat : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${iterStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>As you can see, the status variable (<code>iterStat</code> in this example) is defined in the <code>th:each</code> attribute by writing its name after the iter variable itself, separated by a comma. As happens to the iter variable, the status variable will only be available inside the fragment of code defined by the tag holding the <code>th:each</code> attribute.</p>
<p>Let's have a look at the result of processing our template:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/css/gtvg.css&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>

    <span class="kw">&lt;h1&gt;</span>Product list<span class="kw">&lt;/h1&gt;</span>
  
    <span class="kw">&lt;table&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;th</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>Fresh Sweet Basil<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>4.99<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>Italian Tomato<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>1.25<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>no<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>Yellow Bell Pepper<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>2.50<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>Old Cheddar<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>18.75<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> colspan=</span><span class="st">&quot;1&quot;</span><span class="ot"> rowspan=</span><span class="st">&quot;1&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/table&gt;</span>
  
    <span class="kw">&lt;p&gt;</span>
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/&quot;</span><span class="ot"> shape=</span><span class="st">&quot;rect&quot;</span><span class="kw">&gt;</span>Return to home<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/p&gt;</span>

  <span class="kw">&lt;/body&gt;</span>
  
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>Note that our iteration status variable has worked perfectly, establishing the <code>odd</code> CSS class only to odd rows (row counting starts with 0).</p>
<blockquote>
<p>All those colspan and rowspan attributes in the <code>&lt;td&gt;</code> tags, as well as the shape one in <code>&lt;a&gt;</code> are automatically added by Thymeleaf in accordance with the DTD for the selected <em>XHTML 1.0 Strict</em> standard, that establishes those values as default for those attributes (remember that our template didn't set a value for them). Don't worry about them at all, because they will not affect the display of your page. As an example, if we were using HTML5 (which has no DTD), those attributes would never be added.</p>
</blockquote>
<p>If you don't explicitly set an iteration variable, Thymeleaf will always create one for you by suffixing <code>Stat</code> to the name of the iter variable:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
</section>
</section>
<section id="conditional-evaluation" class="level1">
<h1><a href="#conditional-evaluation">7 Conditional evaluation</a></h1>
<section id="simple-conditionals-if-and-unless" class="level2">
<h2><a href="#simple-conditionals-if-and-unless">7.1 Simple conditionals: &quot;if&quot; and &quot;unless&quot;</a></h2>
<p>Sometimes you will need a fragment of your template only to appear in the result if a certain condition is met.</p>
<p>For example, imagine we want to show in our product table a column with the number of comments that exist for each product and, if there are any comments, a link to the comment detail page for that product.</p>
<p>In order to do this, we would use the <code>th:if</code> attribute:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#lists.size(prod.comments)}&quot;</span><span class="kw">&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span> 
<span class="er">         th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">         th:if</span><span class="ot">=</span><span class="st">&quot;${not #lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>Quite a lot of things to see here, so let's focus on the important line:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span>
<span class="er">   th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">   th:if</span><span class="ot">=</span><span class="st">&quot;${not #lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span></code></pre>
<p>There is little to explain from this code, in fact: We will be creating a link to the comments page (with URL <code>/product/comments</code>) with a <code>prodId</code> parameter set to the <code>id</code> of the product, but only if the product has any comments.</p>
<p>Let's have a look at the resulting markup (getting rid of the defaulted <code>rowspan</code> and <code>colspan</code> attributes for a cleaner view):</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Fresh Sweet Basil<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>4.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Italian Tomato<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.25<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=2&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Yellow Bell Pepper<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>2.50<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Old Cheddar<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>18.75<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>1<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=4&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>Perfect! That's exactly what we wanted.</p>
<p>Note that the <code>th:if</code> attribute will not only evaluate <em>boolean</em> conditions. It's capabilities go a little beyond that, and it will evaluate the specified expression as <code>true</code> following these rules:</p>
<ul>
<li>If value is not null:
<ul>
<li>If value is a boolean and is <code>true</code>.</li>
<li>If value is a number and is non-zero</li>
<li>If value is a character and is non-zero</li>
<li>If value is a String and is not &quot;false&quot;, &quot;off&quot; or &quot;no&quot;</li>
<li>If value is not a boolean, a number, a character or a String.</li>
</ul></li>
<li>(If value is null, th:if will evaluate to false).</li>
</ul>
<p>Also, <code>th:if</code> has a negative counterpart, <code>th:unless</code>, which we could have used in the previous example instead of using a <code>not</code> inside the OGNL expression:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span>
<span class="er">   th:href</span><span class="ot">=</span><span class="st">&quot;@{/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">   th:unless</span><span class="ot">=</span><span class="st">&quot;${#lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span></code></pre>
</section>
<section id="switch-statements" class="level2">
<h2><a href="#switch-statements">7.2 Switch statements</a></h2>
<p>There is also a way to display content conditionally using the equivalent of a <em>switch</em> structure in Java: the <code>th:switch</code> / <code>th:case</code> attribute set.</p>
<p>They work exactly as you would expect:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:switch=</span><span class="st">&quot;${user.role}&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> th:case=</span><span class="st">&quot;&#39;admin&#39;&quot;</span><span class="kw">&gt;</span>User is an administrator<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> th:case=</span><span class="st">&quot;#{roles.manager}&quot;</span><span class="kw">&gt;</span>User is a manager<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>Note that as soon as one <code>th:case</code> attribute is evaluated as <code>true</code>, every other <code>th:case</code> attribute in the same switch context is evaluated as <code>false</code>.</p>
<p>The default option is specified as <code>th:case=&quot;*&quot;</code>:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:switch=</span><span class="st">&quot;${user.role}&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> th:case=</span><span class="st">&quot;&#39;admin&#39;&quot;</span><span class="kw">&gt;</span>User is an administrator<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> th:case=</span><span class="st">&quot;#{roles.manager}&quot;</span><span class="kw">&gt;</span>User is a manager<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> th:case=</span><span class="st">&quot;*&quot;</span><span class="kw">&gt;</span>User is some other thing<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
</section>
</section>
<section id="template-layout" class="level1">
<h1><a href="#template-layout">8 Template Layout</a></h1>
<section id="including-template-fragments" class="level2">
<h2><a href="#including-template-fragments">8.1 Including template fragments</a></h2>
<p>We will often want to include in our templates fragments from other templates. Common uses for this are footers, headers, menus...</p>
<p>In order to do this, Thymeleaf needs us to define the fragments available for inclusion, which we can do by using the <code>th:fragment</code> attribute.</p>
<p>Now let's say we want to add a standard copyright footer to all our grocery pages, and for that we define a <code>/WEB-INF/templates/footer.html</code> file containing this code:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;body&gt;</span>
  
    <span class="kw">&lt;div</span><span class="ot"> th:fragment=</span><span class="st">&quot;copy&quot;</span><span class="kw">&gt;</span>
      <span class="dv">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery
    <span class="kw">&lt;/div&gt;</span>
  
  <span class="kw">&lt;/body&gt;</span>
  
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>The code above defines a fragment called <code>copy</code> that we can easily include in our home page using one of the <code>th:include</code> or <code>th:substituteby</code> attributes:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body&gt;</span>

  ...

  <span class="kw">&lt;div</span><span class="ot"> th:include=</span><span class="st">&quot;footer :: copy&quot;</span><span class="kw">&gt;&lt;/div&gt;</span>
  
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>The syntax for both these inclusion attributes is quite straightforward. There are three different formats:</p>
<ul>
<li><p><code>&quot;templatename::fragname&quot;</code> Includes the fragment named fragname, which should have been specified with a <code>th:fragment</code> attribute in the template named <code>templatename</code>.</p></li>
<li><p><code>&quot;templatename::[domselector]&quot;</code> Includes as a fragment the result of executing the specified DOM Selector expression on the template named <code>templatename</code>. No <code>th:fragment</code> attributes are needed.</p></li>
</ul>
<blockquote>
<p>DOM Selectors are similar to XPath expressions, see the javadoc specification for the <code>org.thymeleaf.dom.DOMSelector</code> class for more info on DOM Selector syntax.</p>
</blockquote>
<ul>
<li><code>&quot;templatename&quot;</code> Includes as a fragment the complete template named <code>templatename</code>.</li>
</ul>
<blockquote>
<p>Note that the template name you use in <code>th:include</code>/<code>th:substituteby</code> tags will have to be resolvable by the Template Resolver currently being used by the Template Engine.</p>
</blockquote>
<p>Both <code>templatename</code> and <code>fragment</code> or <code>xpathexpr</code> in the above syntax examples can be fully-featured expressions (even conditionals!) like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:include=</span><span class="st">&quot;footer :: (${user.isAdmin}? #{footer.admin} : #{footer.normaluser})&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></code></pre>
<p>Fragments can include any <code>th:* attributes</code>. These attributes will be evaluated once the fragment is included into the target template (the one with the <code>th:include</code>/<code>th:substituteby</code> attribute), and they will be able to reference any context variables defined in this target template.</p>
<blockquote>
<p>A big advantage of this approach to fragments is that you can write your fragments' code in pages that are perfectly displayable by a browser, with a complete and even validating XHTML structure, while still retaining the ability to make Thymeleaf include them into other templates.</p>
</blockquote>
<p>And what is the difference between <code>th:include</code> and <code>th:substituteby</code>? Whereas <code>th:include</code> will include the contents of the fragment into its host tag, <code>th:substituteby</code> will actually substitute the host tag by the fragment's. So that an HTML5 fragment like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;footer</span><span class="ot"> th:fragment=</span><span class="st">&quot;copy&quot;</span><span class="kw">&gt;</span>
  <span class="dv">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery
<span class="kw">&lt;/footer&gt;</span></code></pre>
<p>...included twice in host <code>&lt;div&gt;</code> tags, like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body&gt;</span>

  ...

  <span class="kw">&lt;div</span><span class="ot"> th:include=</span><span class="st">&quot;footer :: copy&quot;</span><span class="kw">&gt;&lt;/div&gt;</span>
  <span class="kw">&lt;div</span><span class="ot"> th:substituteby=</span><span class="st">&quot;footer :: copy&quot;</span><span class="kw">&gt;&lt;/div&gt;</span>
  
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>...will result in:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body&gt;</span>

  ...

  <span class="kw">&lt;div&gt;</span>
    <span class="dv">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery
  <span class="kw">&lt;/div&gt;</span>
  <span class="kw">&lt;footer&gt;</span>
    <span class="dv">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery
  <span class="kw">&lt;/footer&gt;</span>
  
<span class="kw">&lt;/body&gt;</span></code></pre>
</section>
<section id="removing-template-fragments" class="level2">
<h2><a href="#removing-template-fragments">8.2 Removing template fragments</a></h2>
<p>Let's revisit the last version of our product list template:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#lists.size(prod.comments)}&quot;</span><span class="kw">&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span> 
<span class="er">         th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">         th:unless</span><span class="ot">=</span><span class="st">&quot;${#lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>This code is just fine as a template, but as a static page (when directly open by a browser without Thymeleaf processing it) it would not make a nice prototype.</p>
<p>Why? Because although perfectly displayable by browsers, that table only has a row, and this row has mock data. As a prototype, it simply wouldn't look realistic enough... we should have more than one product, <em>we need more rows</em>.</p>
<p>So let's add some:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#lists.size(prod.comments)}&quot;</span><span class="kw">&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span> 
<span class="er">         th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">         th:unless</span><span class="ot">=</span><span class="st">&quot;${#lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Blue Lettuce<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>9.55<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Mild Cinnamon<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>3<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>Ok, now we have three, definitely better for a prototype. But... what will happen when we process it with Thymeleaf?:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Fresh Sweet Basil<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>4.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Italian Tomato<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.25<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=2&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Yellow Bell Pepper<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>2.50<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Old Cheddar<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>18.75<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>1<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=4&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Blue Lettuce<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>9.55<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Mild Cinnamon<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>3<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>The last two rows are mock rows! Well, of course they are: iteration was only applied to the first row, so there is no reason why Thymeleaf should have removed the other two.</p>
<p>We need a way to remove those two rows during template processing. Let's use the <code>th:remove</code> attribute on the second and third <code>&lt;tr&gt;</code> tags:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#lists.size(prod.comments)}&quot;</span><span class="kw">&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span> 
<span class="er">         th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">         th:unless</span><span class="ot">=</span><span class="st">&quot;${#lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="ot"> th:remove=</span><span class="st">&quot;all&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Blue Lettuce<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>9.55<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> th:remove=</span><span class="st">&quot;all&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Mild Cinnamon<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>3<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>Once processed, everything will look again as it should:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Fresh Sweet Basil<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>4.99<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Italian Tomato<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>1.25<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=2&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;td&gt;</span>Yellow Bell Pepper<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>2.50<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;td&gt;</span>Old Cheddar<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>18.75<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;td&gt;</span>
      <span class="kw">&lt;span&gt;</span>1<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/gtvg/product/comments?prodId=4&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/td&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>And what about that all value in the attribute, what does it mean? Well, in fact <code>th:remove</code> can behave in three different ways, depending on its value:</p>
<ul>
<li><code>all</code>: Remove both the containing tag and all its children.</li>
<li><code>body</code>: Do not remove the containing tag, but remove all its children.</li>
<li><code>tag</code>: Remove the containing tag, but do not remove its children.</li>
<li><code>all-but-first</code>: Remove all children of the containing tag except the first one.</li>
</ul>
<p>What can that <code>all-but-first</code> value be useful for? It will let us save some <code>th:remove=&quot;all&quot;</code> when prototyping:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;thead&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;th&gt;</span>NAME<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;th&gt;</span>PRICE<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;th&gt;</span>IN STOCK<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;th&gt;</span>COMMENTS<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;/thead&gt;</span>
  <span class="kw">&lt;tbody</span><span class="ot"> th:remove=</span><span class="st">&quot;all-but-first&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${prodStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.name}&quot;</span><span class="kw">&gt;</span>Onions<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.price}&quot;</span><span class="kw">&gt;</span>2.41<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${prod.inStock}? #{true} : #{false}&quot;</span><span class="kw">&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>
        <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#lists.size(prod.comments)}&quot;</span><span class="kw">&gt;</span>2<span class="kw">&lt;/span&gt;</span> comment/s
        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span> 
<span class="er">           th:href</span><span class="ot">=</span><span class="st">&quot;@{/product/comments(prodId=${prod.id})}&quot;</span> 
<span class="er">           th:unless</span><span class="ot">=</span><span class="st">&quot;${#lists.isEmpty(prod.comments)}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
      <span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;tr</span><span class="ot"> class=</span><span class="st">&quot;odd&quot;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;td&gt;</span>Blue Lettuce<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>9.55<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>no<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>
        <span class="kw">&lt;span&gt;</span>0<span class="kw">&lt;/span&gt;</span> comment/s
      <span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;td&gt;</span>Mild Cinnamon<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>1.99<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>yes<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>
        <span class="kw">&lt;span&gt;</span>3<span class="kw">&lt;/span&gt;</span> comment/s
        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;comments.html&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
      <span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;/tbody&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
</section>
</section>
<section id="local-variables" class="level1">
<h1><a href="#local-variables">9 Local variables</a></h1>
<p>Thymeleaf calls <em>local variables</em> those variables that are defined for a specific fragment of a template, and are only available for evaluation inside that fragment.</p>
<p>An example we have already seen is the <code>prod</code> iter variable in our product list page:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;prod : ${prods}&quot;</span><span class="kw">&gt;</span>
    ...
<span class="kw">&lt;/tr&gt;</span></code></pre>
<p>That <code>prod</code> variable will be available only within the bonds of the <code>&lt;tr&gt;</code> tag. Specifically:</p>
<ul>
<li>It will be available for any other <code>th:*</code> attributes executing in that tag with less <em>precedence</em> than <code>th:each</code> (which means they will execute after <code>th:each</code>).</li>
<li>It will be available for any child element of the <code>&lt;tr&gt;</code> tag, such as <code>&lt;td&gt;</code> elements.</li>
</ul>
<p>Thymeleaf offers you a way to declare local variables without iteration. It is the <code>th:with</code> attribute, and its syntax is like that of attribute value assignation:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:with=</span><span class="st">&quot;firstPer=${persons[0]}&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;p&gt;</span>The name of the first person is <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${firstPer.name}&quot;</span><span class="kw">&gt;</span>Julius Caesar<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>When <code>th:with</code> is processed, that <code>firstPer</code> variable is created as a local variable and added to the variables map coming from the context, so that it is as available for evaluation as any other variables declared in the context from the beginning, but only within the bounds of the containing <code>&lt;div&gt;</code> tag.</p>
<p>You can define several variables at the same time using the usual multiple assignation syntax:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> th:with=</span><span class="st">&quot;firstPer=${persons[0]},secondPer=${persons[1]}&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;p&gt;</span>The name of the first person is <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${firstPer.name}&quot;</span><span class="kw">&gt;</span>Julius Caesar<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;p&gt;</span>But the name of the second person is <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${secondPer.name}&quot;</span><span class="kw">&gt;</span>Marcus Antonius<span class="kw">&lt;/span&gt;</span>.<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>Let's use this in our Grocery's home page! Remember the code we wrote for outputting a formatted date?</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#calendars.format(today,&#39;dd MMMM yyyy&#39;)}&quot;</span><span class="kw">&gt;</span>13 february 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
<p>Well, what if we wanted that <code>&quot;dd MMMM yyyy&quot;</code> to actually depend on the locale? For example, we might want to add the following message to our <code>home_en.properties</code>:</p>
<pre><code>date.format=MMMM dd&#39;,&#39; yyyy</code></pre>
<p>...and an equivalent one to our <code>home_es.properties</code>:</p>
<pre><code>date.format=dd &#39;de&#39; MMMM&#39;,&#39; yyyy</code></pre>
<p>Now, let's use <code>th:with</code> to get the localized date format into a variable, and then use it in our <code>th:text</code> expression:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:with=</span><span class="st">&quot;df=#{date.format}&quot;</span><span class="kw">&gt;</span>
  Today is: <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${#calendars.format(today,df)}&quot;</span><span class="kw">&gt;</span>13 february 2011<span class="kw">&lt;/span&gt;</span>
<span class="kw">&lt;/p&gt;</span></code></pre>
<p>That was clean and easy. In fact, given the fact that <code>th:with</code> has a higher <code>precedence</code> than <code>th:text</code>, we could have solved this all in the <code>span</code> tag:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>
  Today is: <span class="kw">&lt;span</span><span class="ot"> th:with=</span><span class="st">&quot;df=#{date.format}&quot;</span><span class="ot"> th:text=</span><span class="st">&quot;${#calendars.format(today,df)}&quot;</span><span class="kw">&gt;</span>13 february 2011<span class="kw">&lt;/span&gt;</span>
<span class="kw">&lt;/p&gt;</span></code></pre>
<p>You might be thinking: Precedence? We haven't talked about that yet! Well, don't worry because that is exactly what next chapter is about.</p>
</section>
<section id="attribute-precedence" class="level1">
<h1><a href="#attribute-precedence">10 Attribute precedence</a></h1>
<p>What happens when you write more than one <code>th:*</code> attribute in the same tag? For example:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;ul&gt;</span>
  <span class="kw">&lt;li</span><span class="ot"> th:each=</span><span class="st">&quot;item : ${items}&quot;</span><span class="ot"> th:text=</span><span class="st">&quot;${item.description}&quot;</span><span class="kw">&gt;</span>Item description here...<span class="kw">&lt;/li&gt;</span>
<span class="kw">&lt;/ul&gt;</span></code></pre>
<p>Of course, we would expect that <code>th:each</code> attribute to execute before the <code>th:text</code> so that we get the results we want, but given the fact that the DOM (Document Object Model) standard does not give any kind of meaning to the order in which the attributes of a tag are written, a <em>precedence</em> mechanism has to be established in the attributes themselves in order to be sure that this will work as expected.</p>
<p>So, all Thymeleaf attributes define a numeric precedence, which establishes the order in which they are executed in the tag. This order is:</p>
<table>
  <thead>
    <th>
Order
</th>
    <th>
Feature
</th>
    <th>
Attributes
</th>
  </thead>
  <tbody>
    <tr>
      <td>
1
</td>
      <td>
Fragment inclusion
</td>
      <td>
<code>th:include</code>
</td>
    </tr>
    <tr>
      <td>
2
</td>
      <td>
Fragment iteration
</td>
      <td>
<code>th:each</code>
</td>
    </tr>
    <tr>
      <td>
3
</td>
      <td>
Conditional evaluation
</td>
      <td>
        
<code>th:if</code><br/> <code>th:unless</code><br/> <code>th:switch</code><br/> <code>th:case</code>
</td>
    </tr>
    <tr>
      <td>
4
</td>
      <td>
Local variable definition
</td>
      <td>
<code>th:with</code>
</td>
    </tr>
    <tr>
      <td>
5
</td>
      <td>
General attribute modification
</td>
      <td>
        
<code>th:attr</code><br/> <code>th:attrprepend</code><br/> <code>th:attrappend</code>
</td>
    </tr>
    <tr>
      <td>
6
</td>
      <td>
Specific attribute modification
</td>
      <td>
<code>th:value</code>, <code>th:href</code>, <code>th:src</code>, etc.
</td>
    </tr>
    <tr>
      <td>
7
</td>
      <td>
Text (tag body modification)
</td>
      <td>
        
<code>th:text</code><br/> <code>th:utext</code>
</td>
    </tr>
    <tr>
      <td>
8
</td>
      <td>
Fragment specification
</td>
      <td>
<code>th:fragment</code>
</td>
    </tr>
    <tr>
      <td>
9
</td>
      <td>
Fragment removal
</td>
      <td>
<code>th:remove</code>
</td>
    </tr>
  </tbody>
</table>

<p>This precedence mechanism means that the above iteration fragment will give exactly the same results if attribute position is inverted (although it would be slightly less readable):</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;ul&gt;</span>
  <span class="kw">&lt;li</span><span class="ot"> th:text=</span><span class="st">&quot;${item.description}&quot;</span><span class="ot"> th:each=</span><span class="st">&quot;item : ${items}&quot;</span><span class="kw">&gt;</span>Item description here...<span class="kw">&lt;/li&gt;</span>
<span class="kw">&lt;/ul&gt;</span></code></pre>
</section>
<section id="inlining" class="level1">
<h1><a href="#inlining">11 Inlining</a></h1>
<section id="text-inlining" class="level2">
<h2><a href="#text-inlining">11.1 Text inlining</a></h2>
<p>Although the Standard Dialect allows us to do almost everything we might need by using tag attributes, there are situations in which we could prefer writing expressions directly into our HTML texts. For example, we could prefer writing this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Hello, [[${session.user.name}]]!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>...instead of this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;</span>Hello, <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${session.user.name}&quot;</span><span class="kw">&gt;</span>Sebastian<span class="kw">&lt;/span&gt;</span>!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>Expressions between <code>[[...]]</code> are considered expression inlining in Thymeleaf, and in them you can use any kind of expression that would also be valid in a <code>th:text</code> attribute.</p>
<p>In order for inlining to work, we must activate it by using the <code>th:inline</code> attribute, which has three possible values or modes (<code>text</code>, <code>javascript</code> and <code>none</code>). Let's try <code>text</code>:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> th:inline=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span>Hello, [[${session.user.name}]]!<span class="kw">&lt;/p&gt;</span></code></pre>
<p>The tag holding the <code>th:inline</code> does not have to be the one containing the inlined expression/s, any parent tag would do:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body</span><span class="ot"> th:inline=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span>

   ...

   <span class="kw">&lt;p&gt;</span>Hello, [[${session.user.name}]]!<span class="kw">&lt;/p&gt;</span>

   ...

<span class="kw">&lt;/body&gt;</span></code></pre>
<p>So you might now be asking: <em>Why aren't we doing this from the beginning? It's less code than all those</em> <code>th:text</code> <em>attributes!</em> Well, be careful there, because although you might find inlining quite interesting, you should always remember that inlined expressions will be displayed verbatim in your HTML files when you open them statically, so you probably won't be able to use them as prototypes anymore!</p>
<p>The difference between how a browser would statically display our fragment of code without using inlining...</p>
<pre class="sourceCode html"><code class="sourceCode html">Hello, Sebastian!</code></pre>
<p>...and using it...</p>
<pre class="sourceCode html"><code class="sourceCode html">Hello, [[${session.user.name}]]!</code></pre>
<p>...is quite clear.</p>
</section>
<section id="script-inlining-javascript-and-dart" class="level2">
<h2><a href="#script-inlining-javascript-and-dart">11.2 Script inlining (JavaScript and Dart)</a></h2>
<p>Thymeleaf offers a series of &quot;scripting&quot; modes for its inlining capabilities, so that you can integrate your date inside scripts created in some script languages.</p>
<p>Current scripting modes are <code>javascript</code> (<code>th:inline=&quot;javascript&quot;</code>) and <code>dart</code> (<code>th:inline=&quot;dart&quot;</code>).</p>
<p>The first thing we can do with script inlining is writing the value of expressions into our scripts, like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> th:inline=</span><span class="st">&quot;javascript&quot;</span><span class="kw">&gt;</span>
<span class="co">/*&lt;![CDATA[*/</span>
    ...

<span class="er">    var username = /*[[${session.user.name}]]*/ &#39;Sebastian&#39;;</span>

<span class="er">    ...</span>
<span class="co">/*]]&gt;*/</span>
<span class="kw">&lt;/script&gt;</span></code></pre>
<p>The <code>/*[[...]]*/</code> syntax, instructs Thymeleaf to evaluate the contained expression. But there are more implications here:</p>
<ul>
<li>Being a javascript comment (<code>/*...*/</code>), our expression will be ignored when displaying the page statically in a browser.</li>
<li>The code after the inline expression (<code>'Sebastian'</code>) will be executed when displaying the page statically.</li>
<li>Thymeleaf will execute the expression and insert the result, but it will also remove all the code in the line after the inline expression itself (the part that is executed when displayed statically).</li>
</ul>
<p>So, the result of executing this will be:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> th:inline=</span><span class="st">&quot;javascript&quot;</span><span class="kw">&gt;</span>
<span class="co">/*&lt;![CDATA[*/</span>
    ...

<span class="er">    var username = &#39;John Apricot&#39;;</span>

<span class="er">    ...</span>
<span class="co">/*]]&gt;*/</span>
<span class="kw">&lt;/script&gt;</span></code></pre>
<p>You can also do it without comments with the same effects, but that will make your script to fail when loaded statically:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> th:inline=</span><span class="st">&quot;javascript&quot;</span><span class="kw">&gt;</span>
<span class="co">/*&lt;![CDATA[*/</span>
    ...

<span class="er">    var username = [[${session.user.name}]];</span>

<span class="er">    ...</span>
<span class="co">/*]]&gt;*/</span>
<span class="kw">&lt;/script&gt;</span></code></pre>
<p>Note that this evaluation is intelligent and not limited to Strings. Thymeleaf will correctly write in Javascript/Dart syntax the following kinds of objects:</p>
<ul>
<li>Strings</li>
<li>Numbers</li>
<li>Booleans</li>
<li>Arrays</li>
<li>Collections</li>
<li>Maps</li>
<li>Beans (objects with <em>getter</em> and <em>setter</em> methods)</li>
</ul>
<p>For example, if we had the following code:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> th:inline=</span><span class="st">&quot;javascript&quot;</span><span class="kw">&gt;</span>
<span class="co">/*&lt;![CDATA[*/</span>
    ...

<span class="er">    var user = /*[[${session.user}]]*/ null;</span>

<span class="er">    ...</span>
<span class="co">/*]]&gt;*/</span>
<span class="kw">&lt;/script&gt;</span></code></pre>
<p>That <code>${session.user}</code> expression will evaluate to a <code>User</code> object, and Thymeleaf will correctly convert it to Javascript syntax:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> th:inline=</span><span class="st">&quot;javascript&quot;</span><span class="kw">&gt;</span>
<span class="co">/*&lt;![CDATA[*/</span>
    ...

<span class="er">    var user = {&#39;age&#39;:null,&#39;firstName&#39;:&#39;John&#39;,&#39;lastName&#39;:&#39;Apricot&#39;,</span>
<span class="er">                &#39;name&#39;:&#39;John Apricot&#39;,&#39;nationality&#39;:&#39;Antarctica&#39;};</span>

<span class="er">    ...</span>
<span class="co">/*]]&gt;*/</span>
<span class="kw">&lt;/script&gt;</span></code></pre>
<section id="adding-code" class="level3">
<h3><a href="#adding-code">Adding code</a></h3>
<p>An additional feature when using javascript inlining is the ability to include code between a special comment syntax <code>/*[+...+]*/</code> so that Thymeleaf will automatically uncomment that code when processing the template:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">23</span>;

<span class="co">/*[+</span>

<span class="co">var msg  = &#39;This is a working application&#39;;</span>

<span class="co">+]*/</span>

<span class="kw">var</span> f = <span class="kw">function</span>() {
    ...</code></pre>
<p>Will be executed as:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">23</span>;

<span class="kw">var</span> msg  = <span class="st">&#39;This is a working application&#39;</span>;

<span class="kw">var</span> f = <span class="kw">function</span>() {
...</code></pre>
<p>You can include expressions inside these comments, and they will be evaluated:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">23</span>;

<span class="co">/*[+</span>

<span class="co">var msg  = &#39;Hello, &#39; + [[${session.user.name}]];</span>

<span class="co">+]*/</span>

<span class="kw">var</span> f = <span class="kw">function</span>() {
...</code></pre>
</section>
<section id="removing-code" class="level3">
<h3><a href="#removing-code">Removing code</a></h3>
<p>It is also possible to make Thymeleaf remove code between special <code>/*[- */</code> and <code>/* -]*/</code> comments, like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> x = <span class="dv">23</span>;

<span class="co">/*[- */</span>

<span class="kw">var</span> msg  = <span class="st">&#39;This is a non-working template&#39;</span>;

<span class="co">/* -]*/</span>

<span class="kw">var</span> f = <span class="kw">function</span>() {
...</code></pre>
</section>
</section>
</section>
<section id="validation-and-doctypes" class="level1">
<h1><a href="#validation-and-doctypes">12 Validation and Doctypes</a></h1>
<section id="validating-templates" class="level2">
<h2><a href="#validating-templates">12.1 Validating templates</a></h2>
<p>As mentioned before, Thymeleaf offers us out-of-the-box two standard template modes that validate our templates before processing them: <code>VALIDXML</code> and <code>VALIDXHTML.</code> These modes require our templates to be not only <em>well-formed XML</em> (which they should always be), but in fact valid according to the specified <code>DTD</code>.</p>
<p>The problem is that if we use the <code>VALIDXHTML</code> mode with templates including a <code>DOCTYPE</code> clause such as this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;<span class="dt">&gt;</span></code></pre>
<p>...we are going to obtain validation errors because the <code>th:*</code> tags do not exist according to that <code>DTD.</code> That's perfectly normal, as the W3C obviously has no reason to include Thymeleaf's features in their standards but, how do we solve it? By changing the <code>DTD.</code></p>
<p>Thymeleaf includes a set of <code>DTD</code> files that mirror the original ones from the XHTML standards, but adding all the available <code>th:*</code> attributes from the Standard Dialect. That's why we have been using this in our templates:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span></code></pre>
<p>That <code>SYSTEM</code> identifier instructs the Thymeleaf parser to resolve the special Thymeleaf-enabled <code>XHTML 1.0 Strict DTD</code> file and use it for validating our template. And don't worry about that <code>http</code> thing, because that is only an identifier, and the <code>DTD</code> file will be locally read from Thymeleaf's jar files.</p>
<blockquote>
<p>Note that because this DOCTYPE declaration is a perfectly valid one, if we open a browser to statically display our template as a prototype it will be rendered in <em>Standards Mode</em>.</p>
</blockquote>
<p>Here you have the complete set of Thymeleaf-enabled <code>DTD</code> declarations for all the supported flavours of XHTML:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-transitional-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-frameset-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml11-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span></code></pre>
<p>Also note that, in order for your IDE to be happy, and even if you are not working in a validating mode, you will need to declare the <code>th</code> namespace in your <code>html</code> tag:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="ot">      xmlns:th=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span></code></pre>
</section>
<section id="doctype-translation" class="level2">
<h2><a href="#doctype-translation">12.2 Doctype translation</a></h2>
<p>It is fine for our templates to have a <code>DOCTYPE</code> like:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span></code></pre>
<p>But it would not be fine for our web applications to send XHTML documents with this <code>DOCTYPE</code> to client browsers, because:</p>
<ul>
<li>They are not <code>PUBLIC</code> (they are <code>SYSTEM DOCTYPE</code>s), and therefore our web would not be validatable with the W3C Validators.</li>
<li>They are not needed, because once processed, all <code>th:*</code> tags will have dissapeared.</li>
</ul>
<p>That's why Thymeleaf includes a mechanism for <em>DOCTYPE translation</em>, which will automatically translate your thymeleaf-specific XHTML <code>DOCTYPE</code>s into standard <code>DOCTYPE</code>s.</p>
<p>For example, if your template is <em>XHTML 1.0 Strict</em> and looks like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>
    ... 
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>After making Thymeleaf process the template, your resulting XHTML will look like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="kw">&gt;</span>
    ... 
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>You don't have to do anything for these transformations to take place: Thymeleaf will take care of them automatically.</p>
</section>
</section>
<section id="some-more-pages-for-our-grocery" class="level1">
<h1><a href="#some-more-pages-for-our-grocery">13 Some more pages for our grocery</a></h1>
<p>Now we know a lot about using Thymeleaf, we can add some new pages to our website for order management.</p>
<p>Note that we will focus on XHTML code, but you can have a look at the bundled source code if you want to see the corresponding controllers.</p>
<section id="order-list" class="level2">
<h2><a href="#order-list">13.1 Order List</a></h2>
<p>Let's start by creating an order list page, <code>/WEB-INF/templates/order/list.html</code>:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>

    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span> 
<span class="er">          href</span><span class="ot">=</span><span class="st">&quot;../../../css/gtvg.css&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/css/gtvg.css}&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body&gt;</span>

    <span class="kw">&lt;h1&gt;</span>Order list<span class="kw">&lt;/h1&gt;</span>
  
    <span class="kw">&lt;table&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;th&gt;</span>DATE<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>CUSTOMER<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>TOTAL<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;&lt;/th&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;o : ${orders}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${oStat.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${#calendars.format(o.date,&#39;dd/MMM/yyyy&#39;)}&quot;</span><span class="kw">&gt;</span>13 jan 2011<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${o.customer.name}&quot;</span><span class="kw">&gt;</span>Frederic Tomato<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${#aggregates.sum(o.orderLines.{purchasePrice * amount})}&quot;</span><span class="kw">&gt;</span>23.32<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td&gt;</span>
          <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;details.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/order/details(orderId=${o.id})}&quot;</span><span class="kw">&gt;</span>view<span class="kw">&lt;/a&gt;</span>
        <span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/table&gt;</span>
  
    <span class="kw">&lt;p&gt;</span>
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;../home.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/}&quot;</span><span class="kw">&gt;</span>Return to home<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/p&gt;</span>
    
  <span class="kw">&lt;/body&gt;</span>
  
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>There's nothing here that should surprise us, except for this little bit of OGNL magic:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${#aggregates.sum(o.orderLines.{purchasePrice * amount})}&quot;</span><span class="kw">&gt;</span>23.32<span class="kw">&lt;/td&gt;</span></code></pre>
<p>What that does is, for each order line (<code>OrderLine</code> object) in the order, multiply its <code>purchasePrice</code> and <code>amount</code> properties (by calling the corresponding <code>getPurchasePrice()</code> and <code>getAmount()</code> methods) and return the result into a list of numbers, later aggregated by the <code>#aggregates.sum(...)</code> function in order to obtain the order total price.</p>
<p>You've got to love the power of OGNL.</p>
</section>
<section id="order-details" class="level2">
<h2><a href="#order-details">13.2 Order Details</a></h2>
<p>Now for the order details page, in which we will make a heavy use of asterisk syntax:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;<span class="dt">&gt;</span>

<span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="er">      xmlns:th</span><span class="ot">=</span><span class="st">&quot;http://www.thymeleaf.org&quot;</span><span class="kw">&gt;</span>

  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Good Thymes Virtual Grocery<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw">/&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> media=</span><span class="st">&quot;all&quot;</span> 
<span class="er">          href</span><span class="ot">=</span><span class="st">&quot;../../../css/gtvg.css&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/css/gtvg.css}&quot;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>

  <span class="kw">&lt;body</span><span class="ot"> th:object=</span><span class="st">&quot;${order}&quot;</span><span class="kw">&gt;</span>

    <span class="kw">&lt;h1&gt;</span>Order details<span class="kw">&lt;/h1&gt;</span>

    <span class="kw">&lt;div&gt;</span>
      <span class="kw">&lt;p&gt;&lt;b&gt;</span>Code:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{id}&quot;</span><span class="kw">&gt;</span>99<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
      <span class="kw">&lt;p&gt;&lt;b&gt;</span>Date:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{#calendars.format(date,&#39;dd MMM yyyy&#39;)}&quot;</span><span class="kw">&gt;</span>13 jan 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
    <span class="kw">&lt;/div&gt;</span>

    <span class="kw">&lt;h2&gt;</span>Customer<span class="kw">&lt;/h2&gt;</span>

    <span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;*{customer}&quot;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;p&gt;&lt;b&gt;</span>Name:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{name}&quot;</span><span class="kw">&gt;</span>Frederic Tomato<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
      <span class="kw">&lt;p&gt;&lt;b&gt;</span>Since:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{#calendars.format(customerSince,&#39;dd MMM yyyy&#39;)}&quot;</span><span class="kw">&gt;</span>1 jan 2011<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
    <span class="kw">&lt;/div&gt;</span>
  
    <span class="kw">&lt;h2&gt;</span>Products<span class="kw">&lt;/h2&gt;</span>
  
    <span class="kw">&lt;table&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;th&gt;</span>PRODUCT<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>AMOUNT<span class="kw">&lt;/th&gt;</span>
        <span class="kw">&lt;th&gt;</span>PURCHASE PRICE<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
      <span class="kw">&lt;tr</span><span class="ot"> th:each=</span><span class="st">&quot;ol,row : *{orderLines}&quot;</span><span class="ot"> th:class=</span><span class="st">&quot;${row.odd}? &#39;odd&#39;&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${ol.product.name}&quot;</span><span class="kw">&gt;</span>Strawberries<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${ol.amount}&quot;</span><span class="ot"> class=</span><span class="st">&quot;number&quot;</span><span class="kw">&gt;</span>3<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td</span><span class="ot"> th:text=</span><span class="st">&quot;${ol.purchasePrice}&quot;</span><span class="ot"> class=</span><span class="st">&quot;number&quot;</span><span class="kw">&gt;</span>23.32<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/table&gt;</span>

    <span class="kw">&lt;div&gt;</span>
      <span class="kw">&lt;b&gt;</span>TOTAL:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{#aggregates.sum(orderLines.{purchasePrice * amount})}&quot;</span><span class="kw">&gt;</span>35.23<span class="kw">&lt;/span&gt;</span>
    <span class="kw">&lt;/div&gt;</span>
  
    <span class="kw">&lt;p&gt;</span>
      <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;list.html&quot;</span><span class="ot"> th:href=</span><span class="st">&quot;@{/order/list}&quot;</span><span class="kw">&gt;</span>Return to order list<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;/p&gt;</span>

  <span class="kw">&lt;/body&gt;</span>
  
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>Not much really new here, except for this nested object selection:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body</span><span class="ot"> th:object=</span><span class="st">&quot;${order}&quot;</span><span class="kw">&gt;</span>

  ...

  <span class="kw">&lt;div</span><span class="ot"> th:object=</span><span class="st">&quot;*{customer}&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;p&gt;&lt;b&gt;</span>Name:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;*{name}&quot;</span><span class="kw">&gt;</span>Frederic Tomato<span class="kw">&lt;/span&gt;&lt;/p&gt;</span>
    ...
  <span class="kw">&lt;/div&gt;</span>

  ...
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>...which makes that <code>*{name}</code> in fact equivalent to:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;p&gt;&lt;b&gt;</span>Name:<span class="kw">&lt;/b&gt;</span> <span class="kw">&lt;span</span><span class="ot"> th:text=</span><span class="st">&quot;${order.customer.name}&quot;</span><span class="kw">&gt;</span>Frederic Tomato<span class="kw">&lt;/span&gt;&lt;/p&gt;</span></code></pre>
</section>
</section>
<section id="more-on-configuration" class="level1">
<h1><a href="#more-on-configuration">14 More on configuration</a></h1>
<section id="template-resolvers" class="level2">
<h2><a href="#template-resolvers">14.1 Template Resolvers</a></h2>
<p>For our Good Thymes Virtual Grocery, we chose an <code>ITemplateResolver</code> implementation called <code>ServletContextTemplateResolver</code> that allowed us to obtain templates as resources from the Servlet Context.</p>
<p>Besides giving you the ability to create your own template resolver by implementing <code>ITemplateResolver,</code> Thymeleaf includes three other implementations out of the box:</p>
<ul>
<li><p><code>org.thymeleaf.templateresolver.ClassLoaderTemplateResolver</code>, which resolves templates as classloader resources, like:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">return</span> Thread.<span class="fu">currentThread</span>().<span class="fu">getContextClassLoader</span>().<span class="fu">getResourceAsStream</span>(templateName);</code></pre></li>
<li><p><code>org.thymeleaf.templateresolver.FileTemplateResolver</code>, which resolves templates as files from the file system, like:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">return</span> <span class="kw">new</span> FileInputStream(<span class="kw">new</span> File(templateName));</code></pre></li>
<li><p><code>org.thymeleaf.templateresolver.UrlTemplateResolver</code>, which resolves templates as URLs (even non-local ones), like:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">return</span> (<span class="kw">new</span> URL(templateName)).<span class="fu">openStream</span>();</code></pre></li>
</ul>
<p>All of the pre-bundled implementations of <code>ITemplateResolver</code> allow the same set of configuration parameters, which include:</p>
<ul>
<li><p>Prefix and suffix (as already seen):</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">setPrefix</span>(<span class="st">&quot;/WEB-INF/templates/&quot;</span>);
templateResolver.<span class="fu">setSuffix</span>(<span class="st">&quot;.html&quot;</span>);</code></pre></li>
<li><p>Template aliases that allow the use of template names that do not directly correspond to file names. If both suffix/prefix and alias exist, alias will be applied before prefix/suffix:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">addTemplateAlias</span>(<span class="st">&quot;adminHome&quot;</span>,<span class="st">&quot;profiles/admin/home&quot;</span>);
templateResolver.<span class="fu">setTemplateAliases</span>(aliasesMap);</code></pre></li>
<li><p>Encoding to be applied when reading templates:</p>
<pre class="sourceCode java"><code class="sourceCode java">templateResolver.<span class="fu">setEncoding</span>(<span class="st">&quot;UTF-8&quot;</span>);</code></pre></li>
<li><p>Default template mode, and patterns for defining other modes for specific templates:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Default is TemplateMode.XHTML</span>
templateResolver.<span class="fu">setTemplateMode</span>(<span class="st">&quot;HTML5&quot;</span>);
templateResolver.<span class="fu">getXhtmlTemplateModePatternSpec</span>().<span class="fu">addPattern</span>(<span class="st">&quot;*.xhtml&quot;</span>);</code></pre></li>
<li><p>Default mode for template cache, and patterns for defining whether specific templates are cacheable or not:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Default is true</span>
templateResolver.<span class="fu">setCacheable</span>(<span class="kw">false</span>);
templateResolver.<span class="fu">getCacheablePatternSpec</span>().<span class="fu">addPattern</span>(<span class="st">&quot;/users/*&quot;</span>);</code></pre></li>
<li><p>TTL in milliseconds for parsed template cache entries originated in this template resolver. If not set, the only way to remove an entry from the cache will be LRU (cache max size exceeded and the entry is the oldest).</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Default is no TTL (only LRU would remove entries)</span>
templateResolver.<span class="fu">setCacheTTLMs</span>(60000L);</code></pre></li>
</ul>
<p>Also, a Template Engine can be set several template resolvers, in which case an order can be established between them for template resolution so that, if the first one is not able to resolve the template, the second one is asked, and so on:</p>
<pre class="sourceCode java"><code class="sourceCode java">ClassLoaderTemplateResolver classLoaderTemplateResolver = <span class="kw">new</span> <span class="fu">ClassLoaderTemplateResolver</span>();
classLoaderTemplateResolver.<span class="fu">setOrder</span>(Integer.<span class="fu">valueOf</span>(<span class="dv">1</span>));

ServletContextTemplateResolver servletContextTemplateResolver = <span class="kw">new</span> <span class="fu">ServletContextTemplateResolver</span>();
servletContextTemplateResolver.<span class="fu">setOrder</span>(Integer.<span class="fu">valueOf</span>(<span class="dv">2</span>));

templateEngine.<span class="fu">addTemplateResolver</span>(classLoaderTemplateResolver);
templateEngine.<span class="fu">addTemplateResolver</span>(servletContextTemplateResolver);</code></pre>
<p>When several template resolvers are applied, it is recommended to specify patterns for each template resolver so that Thymeleaf can quickly discard those template resolvers that are not meant to resolve the template, enhancing performance. Doing this is not a requirement, but an optimization:</p>
<pre class="sourceCode java"><code class="sourceCode java">ClassLoaderTemplateResolver classLoaderTemplateResolver = <span class="kw">new</span> <span class="fu">ClassLoaderTemplateResolver</span>();
classLoaderTemplateResolver.<span class="fu">setOrder</span>(Integer.<span class="fu">valueOf</span>(<span class="dv">1</span>));
<span class="co">// This classloader will not be even asked for any templates not matching these patterns </span>
classLoaderTemplateResolver.<span class="fu">getResolvablePatternSpec</span>().<span class="fu">addPattern</span>(<span class="st">&quot;/layout/*.html&quot;</span>);
classLoaderTemplateResolver.<span class="fu">getResolvablePatternSpec</span>().<span class="fu">addPattern</span>(<span class="st">&quot;/menu/*.html&quot;</span>);

ServletContextTemplateResolver servletContextTemplateResolver = <span class="kw">new</span> <span class="fu">ServletContextTemplateResolver</span>();
servletContextTemplateResolver.<span class="fu">setOrder</span>(Integer.<span class="fu">valueOf</span>(<span class="dv">2</span>));</code></pre>
</section>
<section id="message-resolvers" class="level2">
<h2><a href="#message-resolvers">14.2 Message Resolvers</a></h2>
<p>We did not explicitly specify a Message Resolver implementation for our Grocery application, and as it was explained before, this meant that the implementation being used was an <code>org.thymeleaf.messageresolver.StandardMessageResolver</code> object.</p>
<p>This <code>StandardMessageResolver,</code> which looks for messages files with the same name as the template in the way already explained, is in fact the only message resolver implementation offered by Thymeleaf core out of the box, although of course you can create your own by just implementing the <code>org.thymeleaf.messageresolver.IMessageResolver</code> interface.</p>
<blockquote>
<p>The thymeleaf-spring3 integration package offers an <code>IMessageResolver</code> implementation which uses the standard Spring way of retrieving externalized messages, by using <code>MessageSource</code> objects.</p>
</blockquote>
<p>What if you wanted to add a message resolver (or more) to the Template Engine? Easy:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// For setting only one</span>
templateEngine.<span class="fu">setMessageResolver</span>(messageResolver);

<span class="co">// For setting more than one</span>
templateEngine.<span class="fu">addMessageResolver</span>(messageResolver);</code></pre>
<p>And why would you want to have more than one message resolver? for the same reason as template resolvers: message resolvers are ordered and if the first one cannot resolve a specific message, the second one will be asked, then the third, etc.</p>
</section>
<section id="logging" class="level2">
<h2><a href="#logging">14.3 Logging</a></h2>
<p>Thymeleaf pays quite a lot of attention to logging, and always tries to offer the maximum amount of useful information through its logging interface.</p>
<p>The logging library used is <code>slf4j,</code> which in fact acts as a bridge to whichever logging implementation you might want to use in your application (for example, <code>log4j</code>).</p>
<p>Thymeleaf classes will log <code>TRACE</code>, <code>DEBUG</code> and <code>INFO</code>-level information, depending on the level of detail you desire, and besides general logging it will use three special loggers associated with the TemplateEngine class which you can configure separately for different purposes:</p>
<ul>
<li><code>org.thymeleaf.TemplateEngine.CONFIG</code> will output detailed configuration of the library during initialization.</li>
<li><code>org.thymeleaf.TemplateEngine.TIMER</code> will output information about the amount of time taken to process each template (useful for benchmarking!)</li>
<li><code>org.thymeleaf.TemplateEngine.cache</code> is the prefix for a set of loggers that output specific information about the caches. Although the names of the cache loggers are configurable by the user and thus could change, by default they are:
<ul>
<li><code>org.thymeleaf.TemplateEngine.cache.TEMPLATE_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.FRAGMENT_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.MESSAGE_CACHE</code></li>
<li><code>org.thymeleaf.TemplateEngine.cache.EXPRESSION_CACHE</code></li>
</ul></li>
</ul>
<p>An example configuration for Thymeleaf's logging infrastructure, using <code>log4j</code>, could be:</p>
<pre><code>log4j.logger.org.thymeleaf=DEBUG
log4j.logger.org.thymeleaf.TemplateEngine.CONFIG=TRACE
log4j.logger.org.thymeleaf.TemplateEngine.TIMER=TRACE
log4j.logger.org.thymeleaf.TemplateEngine.cache.TEMPLATE_CACHE=TRACE</code></pre>
</section>
</section>
<section id="template-cache" class="level1">
<h1><a href="#template-cache">15 Template Cache</a></h1>
<p>Thymeleaf works thanks to a DOM processing engine and a series of processors –one for each type of node that needs to apply logic– that modify the document's DOM tree in order to create the results you expect by combining this tree with your data.</p>
<p>It also includes –by default– a cache that stores parsed templates, this is, the DOM trees resulting from reading and parsing template files before processing them. This is especially useful when working in a web application, and builds on the following concepts:</p>
<ul>
<li>Input/Output is almost always the slowest part of any application. In-memory process is extremely quick compared to it.</li>
<li>Cloning an existing in-memory DOM-tree is always much quicker than reading a template file, parsing it and creating a new DOM object tree for it.</li>
<li>Web applications usually only have a few dozen templates.</li>
<li>Template files are small-to-medium size, and they are not modified while the application is running.</li>
</ul>
<p>This all leads to the idea that caching the most used templates in a web application is feasible without wasting big amounts of memory, and also that it will save a lot of time that would be spent on input/output operations on a small set of files that, in fact, never change.</p>
<p>And how can we take control of this cache? First, we've learned before that we can enable or disable it at the Template Resolver, even acting only on specific templates:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Default is true</span>
templateResolver.<span class="fu">setCacheable</span>(<span class="kw">false</span>);
templateResolver.<span class="fu">getCacheablePatternSpec</span>().<span class="fu">addPattern</span>(<span class="st">&quot;/users/*&quot;</span>);</code></pre>
<p>Also, we could modify its configuration by establishing our own <em>Cache Manager</em> object, which could be an instance of the default <code>StandardCacheManager</code> implementation:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Default is 50</span>
StandardCacheManager cacheManager = <span class="kw">new</span> <span class="fu">StandardCacheManager</span>();
cacheManager.<span class="fu">setTemplateCacheMaxSize</span>(<span class="dv">100</span>);
...
templateEngine.<span class="fu">setCacheManager</span>(cacheManager);</code></pre>
<p>Refer to the javadoc API of <code>org.thymeleaf.cache.StandardCacheManager</code> for more info on configuring the caches.</p>
<p>Entries can be manually removed from the template cache:</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">// Clear the cache completely</span>
templateEngine.<span class="fu">clearTemplateCache</span>();

<span class="co">// Clear a specific template from the cache</span>
templateEngine.<span class="fu">clearTemplateCacheFor</span>(<span class="st">&quot;/users/userList&quot;</span>);</code></pre>
</section>
<section id="appendix-expression-utility-objects" class="level1">
<h1><a href="#appendix-expression-utility-objects">16 Appendix: Expression Utility Objects</a></h1>
<ul>
<li><strong>#dates</strong> : utility methods for <code>java.util.Date</code> objects:</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Dates</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Null-safe toString()</span>
<span class="co"> */</span>
${#strings.<span class="fu">toString</span>(obj)}                           <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Format date with the standard locale format</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#dates<span class="fu">.format</span>(date)}
${#dates.<span class="fu">arrayFormat</span>(datesArray)}
${#dates.<span class="fu">listFormat</span>(datesList)}
${#dates.<span class="fu">setFormat</span>(datesSet)}

<span class="co">/*</span>
<span class="co"> * Format date with the specified pattern</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#dates<span class="fu">.format</span>(date, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#dates.<span class="fu">arrayFormat</span>(datesArray, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#dates.<span class="fu">listFormat</span>(datesList, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#dates.<span class="fu">setFormat</span>(datesSet, &#39;dd/MMM/yyyy HH:mm&#39;)}

<span class="co">/*</span>
<span class="co"> * Obtain date properties</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#dates.<span class="fu">day</span>(date)}                    <span class="co">// also arrayDay(...), listDay(...), etc.</span>
${#dates.<span class="fu">month</span>(date)}                  <span class="co">// also arrayMonth(...), listMonth(...), etc.</span>
${#dates.<span class="fu">monthName</span>(date)}              <span class="co">// also arrayMonthName(...), listMonthName(...), etc.</span>
${#dates.<span class="fu">monthNameShort</span>(date)}         <span class="co">// also arrayMonthNameShort(...), listMonthNameShort(...), etc.</span>
${#dates.<span class="fu">year</span>(date)}                   <span class="co">// also arrayYear(...), listYear(...), etc.</span>
${#dates.<span class="fu">dayOfWeek</span>(date)}              <span class="co">// also arrayDayOfWeek(...), listDayOfWeek(...), etc.</span>
${#dates.<span class="fu">dayOfWeekName</span>(date)}          <span class="co">// also arrayDayOfWeekName(...), listDayOfWeekName(...), etc.</span>
${#dates.<span class="fu">dayOfWeekNameShort</span>(date)}     <span class="co">// also arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...), etc.</span>
${#dates.<span class="fu">hour</span>(date)}                   <span class="co">// also arrayHour(...), listHour(...), etc.</span>
${#dates.<span class="fu">minute</span>(date)}                 <span class="co">// also arrayMinute(...), listMinute(...), etc.</span>
${#dates.<span class="fu">second</span>(date)}                 <span class="co">// also arraySecond(...), listSecond(...), etc.</span>
${#dates.<span class="fu">millisecond</span>(date)}            <span class="co">// also arrayMillisecond(...), listMillisecond(...), etc.</span>

<span class="co">/*</span>
<span class="co"> * Create date (java.util.Date) objects from its components</span>
<span class="co"> */</span>
${#dates.<span class="fu">create</span>(year,month,day)}
${#dates.<span class="fu">create</span>(year,month,day,hour,minute)}
${#dates.<span class="fu">create</span>(year,month,day,hour,minute,second)}
${#dates.<span class="fu">create</span>(year,month,day,hour,minute,second,millisecond)}

<span class="co">/*</span>
<span class="co"> * Create a date (java.util.Date) object for the current date and time</span>
<span class="co"> */</span>
${#dates.<span class="fu">createNow</span>()}

<span class="co">/*</span>
<span class="co"> * Create a date (java.util.Date) object for the current date (time set to 00:00)</span>
<span class="co"> */</span>
${#dates.<span class="fu">createToday</span>()}</code></pre>
<ul>
<li><strong>#calendars</strong> : analogous to <code>#dates</code>, but for <code>java.util.Calendar</code> objects:</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Calendars</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Format calendar with the standard locale format</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#calendars<span class="fu">.format</span>(cal)}
${#calendars.<span class="fu">arrayFormat</span>(calArray)}
${#calendars.<span class="fu">listFormat</span>(calList)}
${#calendars.<span class="fu">setFormat</span>(calSet)}

<span class="co">/*</span>
<span class="co"> * Format calendar with the specified pattern</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#calendars<span class="fu">.format</span>(cal, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#calendars.<span class="fu">arrayFormat</span>(calArray, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#calendars.<span class="fu">listFormat</span>(calList, &#39;dd/MMM/yyyy HH:mm&#39;)}
${#calendars.<span class="fu">setFormat</span>(calSet, &#39;dd/MMM/yyyy HH:mm&#39;)}

<span class="co">/*</span>
<span class="co"> * Obtain calendar properties</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#calendars.<span class="fu">day</span>(date)}                <span class="co">// also arrayDay(...), listDay(...), etc.</span>
${#calendars.<span class="fu">month</span>(date)}              <span class="co">// also arrayMonth(...), listMonth(...), etc.</span>
${#calendars.<span class="fu">monthName</span>(date)}          <span class="co">// also arrayMonthName(...), listMonthName(...), etc.</span>
${#calendars.<span class="fu">monthNameShort</span>(date)}     <span class="co">// also arrayMonthNameShort(...), listMonthNameShort(...), etc.</span>
${#calendars.<span class="fu">year</span>(date)}               <span class="co">// also arrayYear(...), listYear(...), etc.</span>
${#calendars.<span class="fu">dayOfWeek</span>(date)}          <span class="co">// also arrayDayOfWeek(...), listDayOfWeek(...), etc.</span>
${#calendars.<span class="fu">dayOfWeekName</span>(date)}      <span class="co">// also arrayDayOfWeekName(...), listDayOfWeekName(...), etc.</span>
${#calendars.<span class="fu">dayOfWeekNameShort</span>(date)} <span class="co">// also arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...), etc.</span>
${#calendars.<span class="fu">hour</span>(date)}               <span class="co">// also arrayHour(...), listHour(...), etc.</span>
${#calendars.<span class="fu">minute</span>(date)}             <span class="co">// also arrayMinute(...), listMinute(...), etc.</span>
${#calendars.<span class="fu">second</span>(date)}             <span class="co">// also arraySecond(...), listSecond(...), etc.</span>
${#calendars.<span class="fu">millisecond</span>(date)}        <span class="co">// also arrayMillisecond(...), listMillisecond(...), etc.</span>

<span class="co">/*</span>
<span class="co"> * Create calendar (java.util.Calendar) objects from its components</span>
<span class="co"> */</span>
${#calendars.<span class="fu">create</span>(year,month,day)}
${#calendars.<span class="fu">create</span>(year,month,day,hour,minute)}
${#calendars.<span class="fu">create</span>(year,month,day,hour,minute,second)}
${#calendars.<span class="fu">create</span>(year,month,day,hour,minute,second,millisecond)}

<span class="co">/*</span>
<span class="co"> * Create a calendar (java.util.Calendar) object for the current date and time</span>
<span class="co"> */</span>
${#calendars.<span class="fu">createNow</span>()}

<span class="co">/*</span>
<span class="co"> * Create a calendar (java.util.Calendar) object for the current date (time set to 00:00)</span>
<span class="co"> */</span>
${#calendars.<span class="fu">createToday</span>()}</code></pre>
<ul>
<li><strong>#numbers</strong> : utility methods for number objects:</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Numbers</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * ==========================</span>
<span class="co"> * Formatting integer numbers</span>
<span class="co"> * ==========================</span>
<span class="co"> */</span>

<span class="co">/* </span>
<span class="co"> * Set minimum integer digits.</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#numbers.<span class="fu">formatInteger</span>(num,<span class="dv">3</span>)}
${#numbers.<span class="fu">arrayFormatInteger</span>(numArray,<span class="dv">3</span>)}
${#numbers.<span class="fu">listFormatInteger</span>(numList,<span class="dv">3</span>)}
${#numbers.<span class="fu">setFormatInteger</span>(numSet,<span class="dv">3</span>)}


<span class="co">/* </span>
<span class="co"> * Set minimum integer digits and thousands separator: </span>
<span class="co"> * &#39;POINT&#39;, &#39;COMMA&#39;, &#39;NONE&#39; or &#39;DEFAULT&#39; (by locale).</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#numbers.<span class="fu">formatInteger</span>(num,<span class="dv">3</span>,&#39;POINT&#39;)}
${#numbers.<span class="fu">arrayFormatInteger</span>(numArray,<span class="dv">3</span>,&#39;POINT&#39;)}
${#numbers.<span class="fu">listFormatInteger</span>(numList,<span class="dv">3</span>,&#39;POINT&#39;)}
${#numbers.<span class="fu">setFormatInteger</span>(numSet,<span class="dv">3</span>,&#39;POINT&#39;)}


<span class="co">/*</span>
<span class="co"> * ==========================</span>
<span class="co"> * Formatting decimal numbers</span>
<span class="co"> * ==========================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Set minimum integer digits and (exact) decimal digits.</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#numbers.<span class="fu">formatDecimal</span>(num,<span class="dv">3</span>,<span class="dv">2</span>)}
${#numbers.<span class="fu">arrayFormatDecimal</span>(numArray,<span class="dv">3</span>,<span class="dv">2</span>)}
${#numbers.<span class="fu">listFormatDecimal</span>(numList,<span class="dv">3</span>,<span class="dv">2</span>)}
${#numbers.<span class="fu">setFormatDecimal</span>(numSet,<span class="dv">3</span>,<span class="dv">2</span>)}

<span class="co">/*</span>
<span class="co"> * Set minimum integer digits and (exact) decimal digits, and also decimal separator.</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#numbers.<span class="fu">formatDecimal</span>(num,<span class="dv">3</span>,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">arrayFormatDecimal</span>(numArray,<span class="dv">3</span>,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">listFormatDecimal</span>(numList,<span class="dv">3</span>,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">setFormatDecimal</span>(numSet,<span class="dv">3</span>,<span class="dv">2</span>,&#39;COMMA&#39;)}

<span class="co">/*</span>
<span class="co"> * Set minimum integer digits and (exact) decimal digits, and also thousands and </span>
<span class="co"> * decimal separator.</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#numbers.<span class="fu">formatDecimal</span>(num,<span class="dv">3</span>,&#39;POINT&#39;,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">arrayFormatDecimal</span>(numArray,<span class="dv">3</span>,&#39;POINT&#39;,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">listFormatDecimal</span>(numList,<span class="dv">3</span>,&#39;POINT&#39;,<span class="dv">2</span>,&#39;COMMA&#39;)}
${#numbers.<span class="fu">setFormatDecimal</span>(numSet,<span class="dv">3</span>,&#39;POINT&#39;,<span class="dv">2</span>,&#39;COMMA&#39;)}



<span class="co">/*</span>
<span class="co"> * ==========================</span>
<span class="co"> * Utility methods</span>
<span class="co"> * ==========================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Create a sequence (array) of integer numbers going</span>
<span class="co"> * from x to y</span>
<span class="co"> */</span>
${#numbers.<span class="fu">sequence</span>(from,to)}
${#numbers.<span class="fu">sequence</span>(from,to,step)}</code></pre>
<ul>
<li><strong>#strings</strong> : utility methods for <code>String</code> objects:</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Strings</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Check whether a String is empty (or null). Performs a trim() operation before check</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">isEmpty</span>(name)}
${#strings.<span class="fu">arrayIsEmpty</span>(nameArr)}
${#strings.<span class="fu">listIsEmpty</span>(nameList)}
${#strings.<span class="fu">setIsEmpty</span>(nameSet)}

<span class="co">/*</span>
<span class="co"> * Check whether a fragment is contained in a String</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">contains</span>(name,&#39;ez&#39;)}                     <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">containsIgnoreCase</span>(name,&#39;ez&#39;)}           <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Check whether a String starts or ends with a fragment</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">startsWith</span>(name,&#39;Don&#39;)}                  <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">endsWith</span>(name,endingFragment)}           <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Substring-related operations</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">indexOf</span>(name,frag)}                      <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">substring</span>(name,<span class="dv">3</span>,<span class="dv">5</span>)}                     <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">substringAfter</span>(name,prefix)}             <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">substringBefore</span>(name,suffix)}            <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">replace</span>(name,&#39;las&#39;,&#39;ler&#39;)}               <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Append and prepend</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">prepend</span>(str,prefix)}                     <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">append</span>(str,suffix)}                      <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Change case</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">toUpperCase</span>(name)}                       <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">toLowerCase</span>(name)}                       <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Split and join</span>
<span class="co"> */</span>
${#strings.<span class="fu">arrayJoin</span>(namesArray,&#39;,&#39;)}
${#strings.<span class="fu">listJoin</span>(namesList,&#39;,&#39;)}
${#strings.<span class="fu">setJoin</span>(namesSet,&#39;,&#39;)}
${#strings.<span class="fu">arraySplit</span>(namesStr,&#39;,&#39;)}                <span class="co">// returns String[]</span>
${#strings.<span class="fu">listSplit</span>(namesStr,&#39;,&#39;)}                 <span class="co">// returns List&lt;String&gt;</span>
${#strings.<span class="fu">setSplit</span>(namesStr,&#39;,&#39;)}                  <span class="co">// returns Set&lt;String&gt;</span>

<span class="co">/*</span>
<span class="co"> * Trim</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">trim</span>(str)}                               <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Compute length</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">length</span>(str)}                             <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Abbreviate text making it have a maximum size of n. If text is bigger, it will be clipped and</span>
<span class="co"> * finished in &quot;...&quot;</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#strings.<span class="fu">abbreviate</span>(str,<span class="dv">10</span>)}                      <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Convert the first character to upper-case (and vice-versa)</span>
<span class="co"> */</span>
${#strings.<span class="fu">capitalize</span>(str)}                         <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">unCapitalize</span>(str)}                       <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Convert the first character of every word to upper-case</span>
<span class="co"> */</span>
${#strings.<span class="fu">capitalizeWords</span>(str)}                    <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">capitalizeWords</span>(str,delimiters)}         <span class="co">// also array*, list* and set*</span>

<span class="co">/*</span>
<span class="co"> * Escape the string</span>
<span class="co"> */</span>
${#strings.<span class="fu">escapeXml</span>(str)}                          <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">escapeJava</span>(str)}                         <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">escapeJavaScript</span>(str)}                   <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">unescapeJava</span>(str)}                       <span class="co">// also array*, list* and set*</span>
${#strings.<span class="fu">unescapeJavaScript</span>(str)}                 <span class="co">// also array*, list* and set*</span></code></pre>
<ul>
<li><strong>#objects</strong> : utility methods for objects in general</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Objects</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Return obj if it is not null, and default otherwise</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#objects.<span class="fu">nullSafe</span>(obj,<span class="kw">default</span>)}
${#objects.<span class="fu">arrayNullSafe</span>(objArray,<span class="kw">default</span>)}
${#objects.<span class="fu">listNullSafe</span>(objList,<span class="kw">default</span>)}
${#objects.<span class="fu">setNullSafe</span>(objSet,<span class="kw">default</span>)}</code></pre>
<ul>
<li><strong>#bools</strong> : utility methods for boolean evaluation</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Bools</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Evaluate a condition in the same way that it would be evaluated in a th:if tag</span>
<span class="co"> * (see conditional evaluation chapter afterwards).</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#bools.<span class="fu">isTrue</span>(obj)}
${#bools.<span class="fu">arrayIsTrue</span>(objArray)}
${#bools.<span class="fu">listIsTrue</span>(objList)}
${#bools.<span class="fu">setIsTrue</span>(objSet)}

<span class="co">/*</span>
<span class="co"> * Evaluate with negation</span>
<span class="co"> * Also works with arrays, lists or sets</span>
<span class="co"> */</span>
${#bools.<span class="fu">isFalse</span>(cond)}
${#bools.<span class="fu">arrayIsFalse</span>(condArray)}
${#bools.<span class="fu">listIsFalse</span>(condList)}
${#bools.<span class="fu">setIsFalse</span>(condSet)}

<span class="co">/*</span>
<span class="co"> * Evaluate and apply AND operator</span>
<span class="co"> * Receive an array, a list or a set as parameter</span>
<span class="co"> */</span>
${#bools.<span class="fu">arrayAnd</span>(condArray)}
${#bools.<span class="fu">listAnd</span>(condList)}
${#bools.<span class="fu">setAnd</span>(condSet)}

<span class="co">/*</span>
<span class="co"> * Evaluate and apply OR operator</span>
<span class="co"> * Receive an array, a list or a set as parameter</span>
<span class="co"> */</span>
${#bools.<span class="fu">arrayOr</span>(condArray)}
${#bools.<span class="fu">listOr</span>(condList)}
${#bools.<span class="fu">setOr</span>(condSet)}</code></pre>
<ul>
<li><strong>#arrays</strong> : utility methods for arrays</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Arrays</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Converts to array, trying to infer array component class.</span>
<span class="co"> * Note that if resulting array is empty, or if the elements</span>
<span class="co"> * of the target object are not all of the same class,</span>
<span class="co"> * this method will return Object[].</span>
<span class="co"> */</span>
${#arrays.<span class="fu">toArray</span>(object)}

<span class="co">/*</span>
<span class="co"> * Convert to arrays of the specified component class.</span>
<span class="co"> */</span>
${#arrays.<span class="fu">toStringArray</span>(object)}
${#arrays.<span class="fu">toIntegerArray</span>(object)}
${#arrays.<span class="fu">toLongArray</span>(object)}
${#arrays.<span class="fu">toDoubleArray</span>(object)}
${#arrays.<span class="fu">toFloatArray</span>(object)}
${#arrays.<span class="fu">toBooleanArray</span>(object)}

<span class="co">/*</span>
<span class="co"> * Compute length</span>
<span class="co"> */</span>
${#arrays.<span class="fu">length</span>(array)}

<span class="co">/*</span>
<span class="co"> * Check whether array is empty</span>
<span class="co"> */</span>
${#arrays.<span class="fu">isEmpty</span>(array)}

<span class="co">/*</span>
<span class="co"> * Check if element or elements are contained in array</span>
<span class="co"> */</span>
${#arrays.<span class="fu">contains</span>(array, element)}
${#arrays.<span class="fu">containsAll</span>(array, elements)}</code></pre>
<ul>
<li><strong>#lists</strong> : utility methods for lists</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Lists</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Converts to list</span>
<span class="co"> */</span>
${#lists.<span class="fu">toList</span>(object)}

<span class="co">/*</span>
<span class="co"> * Compute size</span>
<span class="co"> */</span>
${#lists.<span class="fu">size</span>(list)}

<span class="co">/*</span>
<span class="co"> * Check whether list is empty</span>
<span class="co"> */</span>
${#lists.<span class="fu">isEmpty</span>(list)}

<span class="co">/*</span>
<span class="co"> * Check if element or elements are contained in list</span>
<span class="co"> */</span>
${#lists.<span class="fu">contains</span>(list, element)}
${#lists.<span class="fu">containsAll</span>(list, elements)}</code></pre>
<ul>
<li><strong>#sets</strong> : utility methods for sets</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Sets</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Converts to set</span>
<span class="co"> */</span>
${#sets.<span class="fu">toSet</span>(object)}

<span class="co">/*</span>
<span class="co"> * Compute size</span>
<span class="co"> */</span>
${#sets.<span class="fu">size</span>(set)}

<span class="co">/*</span>
<span class="co"> * Check whether set is empty</span>
<span class="co"> */</span>
${#sets.<span class="fu">isEmpty</span>(set)}

<span class="co">/*</span>
<span class="co"> * Check if element or elements are contained in set</span>
<span class="co"> */</span>
${#sets.<span class="fu">contains</span>(set, element)}
${#sets.<span class="fu">containsAll</span>(set, elements)}</code></pre>
<ul>
<li><strong>#maps</strong> : utility methods for maps</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Maps</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Compute size</span>
<span class="co"> */</span>
${#maps.<span class="fu">size</span>(map)}

<span class="co">/*</span>
<span class="co"> * Check whether map is empty</span>
<span class="co"> */</span>
${#maps.<span class="fu">isEmpty</span>(map)}

<span class="co">/*</span>
<span class="co"> * Check if key/s or value/s are contained in maps</span>
<span class="co"> */</span>
${#maps.<span class="fu">containsKey</span>(map, key)}
${#maps.<span class="fu">containsAllKeys</span>(map, keys)}
${#maps.<span class="fu">containsValue</span>(map, value)}
${#maps.<span class="fu">containsAllValues</span>(map, value)}</code></pre>
<ul>
<li><strong>#aggregates</strong> : utility methods for creating aggregates on arrays or collections</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Aggregates</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Compute sum. Returns null if array or collection is empty</span>
<span class="co"> */</span>
${#aggregates.<span class="fu">sum</span>(array)}
${#aggregates.<span class="fu">sum</span>(collection)}

<span class="co">/*</span>
<span class="co"> * Compute average. Returns null if array or collection is empty</span>
<span class="co"> */</span>
${#aggregates.<span class="fu">avg</span>(array)}
${#aggregates.<span class="fu">avg</span>(collection)}</code></pre>
<ul>
<li><strong>#messages</strong> : utility methods for obtaining externalized messages inside variables expressions, in the same way as they would be obtained using <code>#{...}</code> syntax.</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Messages</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Obtain externalized messages. Can receive a single key, a key plus arguments,</span>
<span class="co"> * or an array/list/set of keys (in which case it will return an array/list/set of </span>
<span class="co"> * externalized messages).</span>
<span class="co"> * If a message is not found, a default message (like &#39;??msgKey??&#39;) is returned.</span>
<span class="co"> */</span>
${#messages.<span class="fu">msg</span>(&#39;msgKey&#39;)}
${#messages.<span class="fu">msg</span>(&#39;msgKey&#39;, param1)}
${#messages.<span class="fu">msg</span>(&#39;msgKey&#39;, param1, param2)}
${#messages.<span class="fu">msg</span>(&#39;msgKey&#39;, param1, param2, param3)}
${#messages.<span class="fu">msgWithParams</span>(&#39;msgKey&#39;, <span class="kw">new</span> Object[] {param1, param2, param3, param4})}
${#messages.<span class="fu">arrayMsg</span>(messageKeyArray)}
${#messages.<span class="fu">listMsg</span>(messageKeyList)}
${#messages.<span class="fu">setMsg</span>(messageKeySet)}

<span class="co">/*</span>
<span class="co"> * Obtain externalized messages or null. Null is returned instead of a default</span>
<span class="co"> * message if a message for the specified key is not found.</span>
<span class="co"> */</span>
${#messages.<span class="fu">msgOrNull</span>(&#39;msgKey&#39;)}
${#messages.<span class="fu">msgOrNull</span>(&#39;msgKey&#39;, param1)}
${#messages.<span class="fu">msgOrNull</span>(&#39;msgKey&#39;, param1, param2)}
${#messages.<span class="fu">msgOrNull</span>(&#39;msgKey&#39;, param1, param2, param3)}
${#messages.<span class="fu">msgOrNullWithParams</span>(&#39;msgKey&#39;, <span class="kw">new</span> Object[] {param1, param2, param3, param4})}
${#messages.<span class="fu">arrayMsgOrNull</span>(messageKeyArray)}
${#messages.<span class="fu">listMsgOrNull</span>(messageKeyList)}
${#messages.<span class="fu">setMsgOrNull</span>(messageKeySet)}</code></pre>
<ul>
<li><strong>#ids</strong> : utility methods for dealing with <code>id</code> attributes that might be repeated (for example, as a result of an iteration).</li>
</ul>
<pre class="sourceCode java"><code class="sourceCode java"><span class="co">/*</span>
<span class="co"> * ======================================================================</span>
<span class="co"> * See javadoc API for class org.thymeleaf.expression.Ids</span>
<span class="co"> * ======================================================================</span>
<span class="co"> */</span>

<span class="co">/*</span>
<span class="co"> * Normally used in th:id attributes, for appending a counter to the id attribute value so that</span>
<span class="co"> * it remains unique even when involved in an iteration process.</span>
<span class="co"> */</span>
${#ids.<span class="fu">seq</span>(&#39;someId&#39;)}

<span class="co">/*</span>
<span class="co"> * Normally used in th:for attributes in &lt;label&gt; tags, so that these labels can refer to Ids</span>
<span class="co"> * generated by means if the #ids.seq(...) function.</span>
<span class="co"> *</span>
<span class="co"> * Depending on whether the &lt;label&gt; goes before or after the element with the #ids.seq(...) function,</span>
<span class="co"> * the &quot;next&quot; (label goes before &quot;seq&quot;) or the &quot;prev&quot; function (label goes after &quot;seq&quot;) function should be</span>
<span class="co"> * called.</span>
<span class="co"> */</span>
${#ids.<span class="fu">next</span>(&#39;someId&#39;)}
${#ids.<span class="fu">prev</span>(&#39;someId&#39;)}</code></pre>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Given the fact that XHTML5 is just XML-formed HTML5 served with the application/xhtml+xml content type, we could also say that Thymeleaf supports XHTML5.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Note that, although this template is valid XHTML, we earlier selected template mode &quot;XHTML&quot; and not &quot;VALIDXHTML&quot;. For now, it will be OK for us to just have validation turned off – but at the same time we don't want our IDE to complain too much.<a href="#fnref2">↩</a></p></li>
</ol>
</section>
		</div>
	</div>

	</div>

</body>

</html>
